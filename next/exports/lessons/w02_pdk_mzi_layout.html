<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>w02_pdk_mzi_layout.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>w02 pdk mzi layout</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-3OIHLLq_.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/preload-helper-g1IWzEZ-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEventListener-4mpeqPxW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jsx-runtime-DUsrKwmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Combination-D2HqSOvH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clsx-FpJB9huX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cn-Cs2e4A8T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/menu-items-B57SjdWM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hotkeys-Dh4gy4JD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/button-D8mnDDLX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Dj-O1Spr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createLucideIcon-BJ2I6csQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/check-CWbw3kKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/select-CgZgQ5hV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/multi-map-D3NvLiI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chevron-right-B_qBg_RU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dropdown-menu-Ciqx4yT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-DqNvr2Rw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/invariant-Amh6wt4N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/merge-5YNOh9ZD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utils-x9KlwLm7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/requests-THIDPq-F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/once-BxRirs3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toDate-Y5T6FHPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSlice-BoaxdS7L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_hasUnicode-CNlKPr15.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useLifecycle-8fgb5Nue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capitalize-L9-XHPtm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ai-model-dropdown-CO52rzQt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/badge-Cm0WUI-_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/use-toast-DKTyV2AR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/constants-BmIIVBf_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Deferred-9HYzcD3r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/config-CbG7e0K6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/uuid-B8w6pjWV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/DeferredRequestRegistry-DfLQSvoS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/connection-B11rCPnY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNonce-D8CLFIrY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capabilities-Bdlrhekp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createReducer-VgoBNe3M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-C3a_7WFa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-0z0sEYV-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzfTz_Dx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DmruaXMM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DU0YrNRK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-_bGPtAsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DsSBESho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-B2TjmP7E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzDb7E9f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stex-C4ZxI0N3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cjs-Ba5CQnxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_arrayReduce-DdxhySYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/type-kFt-n-jZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseProperty-D0ckTA0L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/now-CAWn5i9V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/debounce-Bgq-wc7M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/main-CC_mbgxK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-DoKM12vd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/kbd-EdFdwHEs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/renderShortcut-CLenKJO6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEvent-l9BzRqpK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeleteCell-BDBSmjLV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lazy-Cbg8zRvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-8c1ixjJ_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/precisionRound-CQhbsDNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-BECdiY5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vega-loader.browser-DZ31-605.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-CSAGVmjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ErrorBoundary-6EjkHrSV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-dialog-D9SwG8oA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dialog-BPIq0Dmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDebounce-C9S6xmGh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/numbers-BigybruE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/SSRProvider-DlZbKHsu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/context-CO64Gasq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNumberFormatter-B5HAJDUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/usePress-DHxqjtDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/input-CVoLDDk-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ImperativeModal-ameyIrhc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cell-link-BiAu_8pk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-D5BMn3Et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/links-Iv0WhyKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/state-i7G4J1VS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/MarimoErrorOutput-Bh7Bgl2Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-BS3uwoaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-DhmkXAPp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-icon-Lyk2_Z8G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spinner-DpaQpaiI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D1pae9A2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/focus-CyxSol0W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/popover-DZBXSGEz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useRunCells-DT1En-Te.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mode-DKDAYLK9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/purify.es-hXMlfS4W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/RenderHTML-Dlz0Ew2i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-CesNYRF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tabs-BjAbB8w_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-missing-import-DV1FOw9w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAsyncData-_-DLduEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useIframeCapabilities-r0LQMxAQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/LazyAnyLanguageCodeMirror-C7KtNlRp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/error-banner-C9tkg1MX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/formats-C3exma5i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useTheme-DpA-8Qyy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/en-US-Lc4gASCJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isValid-Cd_L_2Pm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/maps-D4abje2p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shim-D-ElLTBO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-CCvBQ7qL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/extends-C2lJEiP_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/emotion-is-prop-valid.esm-c4A1huxA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDateFormatter-BMdQ9MI_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/katex-BmfUoCWW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/marked.esm-idL59iHw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-T7OEMACY-CdGEwedE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/range-Bbli-TEL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-kHJ0xpFt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DxdWGPFi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/name-cell-input-C6ZYU6mN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useHotkey-B0ylhc2m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CqHWOZu2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BcLYYUSi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BVXr6b5T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BrEX5EQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CalRK9ms.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Cc4T7UUX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D3MC5WiF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DgaCIZAa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-rqHtY98i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-tj-jaP-y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-w7c0BKrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CCZcRJI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CrDb6akR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/apl-BQt6lLuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asciiarmor-BjX7bs0j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asn1-xn1MtyoW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/brainfuck-BjO-UY1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clike-DW9tQWfF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clojure-BSW96HRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cmake-C7UlMfz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cobol-CyWIev3Y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/coffeescript-DTvziYTK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/commonlisp-yMdkdGMi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/crystal-BGnoSp3z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/css-D7fWzevp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cypher-Cr1dl0Qf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/d-C2bS5bA6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/diff-B2mHQyn6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dtd-Cy-lUE7p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dylan-mm60grwk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ecl-Cqi05Wy1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eiffel-FkvfLQq7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/elm-Da5txHw0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/erlang-CdnCEH5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/simple-mode-B185hCuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/factor-CamlR8EJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/forth-UcMX0m31.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/fortran-DZ_vNVsP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gas-CM88o6Zj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gherkin-BhrpTeN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/groovy-BFju68Wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haskell-CrWHY4et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haxe-1eKW-tbO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/idl-Do4AwvU2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/javascript-CTXZKRYd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/julia-BRynwHI4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/livescript-ZmIBNA-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lua-mUfZ-MRC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mathematica-Dil5dTHO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mbox-Dnkn9wSr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mirc-auEWieOB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mllike-xVJsauJ8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/modelica-B8kajVDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mscgen-Bsnta1jn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mumps-CMw16b5q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/nsis-DwPdi8sw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ntriples-O5lQxirn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/octave-CMfAar-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/oz-CLRI9Qww.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pascal-D2M_3HBx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/perl-B8lV7aKt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pig-Bima2bfE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/powershell-v_t41ydu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/properties-ChrStSby.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/protobuf-Bin6kmlf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pug-UWVdYLYW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/puppet-DYrtWvYn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/python-BuKrulde.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/q-CrXUTiVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/r-Bk2Tiso2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/rpm-CmmZphz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ruby-ElyOTVeQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sas-jE3ZlG0K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/scheme-CZF1tRbv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shell-LqT3ZqMa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sieve-y15yT7Pp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/smalltalk-pk5PvsMs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sparql-DTZ_gfPQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stylus-CrGj0eNT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/swift-tt3PlBbI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tcl-1P4b0GMJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textile-BHDIuMYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toml-C8qoqk_i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/troff-DMiF5Zmz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-cfg-qLZtNU-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-BAUp3RZn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/turtle-BizIwmKv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vb-Bn_uCxNL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vbscript-BTKW8Atx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/velocity-CcB05fpi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/verilog-BWdtOJH8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vhdl-CzFOaOHx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/webidl-DDEKCqSy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/xquery-BcF6ZhQP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/yacas-BARQAiXa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/z80-DO_Ep0iT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-DnNh7vdQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/objectWithoutPropertiesLoose-DDabolgJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-Crqxhl3F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-Df8Wb7xS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-D8ETq-cc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/icons-BgmgMjOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/blob-LiDbeYko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-cell-with-ai-85tnyxYo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chart-no-axes-column-BrQ3B3xc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-function-D5EEjILG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spec-DpllSlJD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useInstallPackage-BaAhpZlP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/column-preview-DGBk0umL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAddCell-DYfGo4T8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toggle-PGHtwx2G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/api-CoLss8_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globals-oV9pRUSB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/share-DjbnD3WE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSet-CKSmZC_I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utilities.esm-DvrcU9Ky.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/floating-outline-DmCT2Mvg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eye-off-BUwXWtH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/plus-CiGrWbgb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/readonly-python-code-CkaJ4Tks.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-video-camera-BGBfFNDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-text-O5IflCIn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-CqXxt3_J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-BMriRmf-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/label-4Nancvon.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textarea-BnZHy5Jt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/circle-x-Cc9X6U_B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-ccw-aU2rUkrI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-2-Du5ITnDv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/form-600t_Civ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/field-Dov6YyOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/switch-Ct8mUApv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useBoolean-Dmwks1uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeepCompareMemoize-C8RdAYFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-D0WVpW93.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/prop-types-WJwGTMoZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/es-DAmFxw3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/VisuallyHidden-RqykLBKh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseFlatten-rM2FaX4x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hasIn-CE-pxQP-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_basePickBy-LbasZ8ix.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pick-FbHfDtcJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/send-LAFRRDPT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/code-xml-DdSOsi73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-Dmmu2U4a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globe-vMZtva7z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-cw-BOc7UXm9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/settings-DznrHqbd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-DhlBDqyx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/triangle-alert-Bf1kg4xT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DL3W3q-2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/bundle.esm-C-9IAWQU.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-CJU5NUvF.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "w02_pdk_mzi_layout.py",
            "mode": "read",
            "version": "0.18.4",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "from _notebook_template import inject_css\n\ninject_css(mo)", "code_hash": "6cb978e63f2955e2bd66085ab06248fe", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "from _notebook_template import make_doc_helpers\n\ndoc_badges, doc_callout_html, doc_callout_list = make_doc_helpers(mo)", "code_hash": "05080628ac7431f1b8289de5a4735a5a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "from _notebook_template import make_section_tabs\n\nsection_tabs, view_state, set_view = make_section_tabs(\n    mo,\n    options=(\"All\", \"Overview\", \"Build MZI + Targets\", \"Layout skeleton\", \"Submission\"),\n    value=\"All\",\n)\nsection_tabs", "code_hash": "8077ff33f74ee007b76293449a272126", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "view = view_state()\nshow_overview = view in [\"All\", \"Overview\"]\nshow_targets = view in [\"All\", \"Build MZI + Targets\"]\nshow_skeleton = view in [\"All\", \"Layout skeleton\"]\nshow_submission = view in [\"All\", \"Submission\"]", "code_hash": "b0abf07445f0a98d54b88f3481c92e4f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "doc_badges(\n    [\n        f\"Notebook view: \u003Cstrong\u003E{view}\u003C/strong\u003E\",\n    ]\n)", "code_hash": "9091f5bf6f4ffe6d2e2aa6ff2e9cc932", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "mo.stop(not show_overview)\nfrom _style import header\n\nheader(\n    mo,\n    title=\"PDK MZI layout (SiEPIC PDK)\",\n    subtitle=(\n        \"Build a first MZI layout using the SiEPIC-EBeam PDK workflow in Python. \"\n        \"Use modelling targets (\u0394L \u2194 FSR) to guide geometry choices, then save your work in the openEBL repo.\"\n    ),\n    badges=[\"Week 2\", \"Lab companion\", \"PDK\", \"openEBL workflow\"],\n    toc=[\n        (\"Overview\", \"overview\"),\n        (\"Build MZI + Targets\", \"targets\"),\n        (\"Layout skeleton\", \"skeleton\"),\n        (\"Submission\", \"submission\"),\n    ],\n    build=\"2025-12-16\",\n)", "code_hash": "4523f87c7387dd7cac99eaa1ff5b7a6f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.stop(not show_overview)\noverview_md = mo.md(r\"\"\"\n\u003Ca id=\"overview\"\u003E\u003C/a\u003E\n## Overview\n\nThis is the **PDK + compact-model + layout** companion for Week 2. The modelling companion is:\n`marimo_course/lessons/w02_mzi_modelling.py`, where you derived and explored the ideal MZI transfer function.\n\nIn this notebook, you'll connect three ideas that show up in every photonics workflow:\n\n- **Compact models:** fast, circuit-level models of components (couplers, waveguides, phase shifters) that let you\n  simulate a whole photonic circuit without solving Maxwell's equations everywhere.\n- **PDK (process design kit):** a foundry/technology \"package\" that defines the **design rules**, **layers**, and\n  **parameterized building blocks** (plus their compact models) so your design is manufacturable and checkable.\n- **Reproducibility across views:** build the *same* MZI you modelled last lesson, first as a **circuit** from compact\n  models and then as a **layout** using PDK cells.\n\nIn lab, you will:\n\n1. Build an MZI from **compact models** (component \u2192 circuit) and sanity-check it against the Week 2 model.\n2. Decide on a **target** (FSR \u2192 \u0394L) near **1550 nm**.\n3. Assemble the same MZI from **PDK building blocks** (splitter, waveguides, combiner, I/O).\n4. Add the **conventions** required for downstream checks (ports/pins, DevRec, labels/floorplan as required).\n5. Save your design in the **openEBL** submission repo and keep CI green.\n\"\"\")\n\ngoals = doc_callout_list(\n    \"info\",\n    tag=\"Learning goals\",\n    title=\"What you should be able to do after this notebook\",\n    items=[\n        \"Explain what a compact model is and why we use them for circuit-level photonics design.\",\n        \"Describe what a PDK provides (layers, rules, cells, models) and why it matters for manufacturable layouts.\",\n        \"Create an MZI from compact-model building blocks and connect \u0394L \u2194 FSR back to the modelling notebook.\",\n        \"Implement the same MZI using PDK-accurate cells so it passes downstream checks.\",\n    ],\n)\n\ngrading_note = doc_callout_list(\n    \"warning\",\n    tag=\"Where is the graded work?\",\n    title=\"Lab companion vs homework\",\n    items=[\n        \"This notebook is a lab companion (workflow + checklists + reference).\",\n        \"Graded work should live in a homework notebook under `marimo_course/assignments/`.\",\n    ],\n)\nmo.vstack([overview_md, goals, grading_note])", "code_hash": "903bc994fcff9499e6e071600be2ec3d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "mo.stop(not show_overview)\nplaced_blocks = mo.ui.checkbox(label=\"Placed I/O + splitter/combiner cells\", value=False)\nrouted = mo.ui.checkbox(label=\"Routed an MZI skeleton with \u0394L\", value=False)\nannotated = mo.ui.checkbox(label=\"Added pins/DevRec/labels as required\", value=False)\nsaved = mo.ui.checkbox(label=\"Saved in openEBL repo + CI checked\", value=False)\nmo.vstack([placed_blocks, routed, annotated, saved])", "code_hash": "e8e637d0de05e1215d78f1fd990ac272", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "mo.stop(not show_overview)\ngo_targets = mo.ui.button(\n    value=0,\n    kind=\"success\",\n    label=\"Go to Build MZI + Targets\",\n    on_click=lambda v: (set_view(\"Build MZI + Targets\"), (v or 0) + 1)[-1],\n)\ngo_skeleton = mo.ui.button(\n    value=0,\n    kind=\"neutral\",\n    label=\"Go to Layout skeleton\",\n    on_click=lambda v: (set_view(\"Layout skeleton\"), (v or 0) + 1)[-1],\n)\ngo_submission = mo.ui.button(\n    value=0,\n    kind=\"neutral\",\n    label=\"Go to Submission\",\n    on_click=lambda v: (set_view(\"Submission\"), (v or 0) + 1)[-1],\n)\nmo.hstack([go_targets, go_skeleton, go_submission], justify=\"start\", gap=1)", "code_hash": "9e990b2339cd07f20aa9617979251f56", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "mo.stop(not show_targets)\nmo.md(r\"\"\"\n\u003Ca id=\"targets\"\u003E\u003C/a\u003E\n## Build the MZI + targets\n\nBuild the MZI from PDK components, render the layout, and then pick a \u0394L that\nmatches your target FSR near 1550 nm.\n\"\"\")", "code_hash": "f5a7bdf5663d639797b06501cdc57193", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.stop(not show_targets)\nimport textwrap\n\nlayout_code = textwrap.dedent(\n    \"\"\"\n    ```python\n    # Build MZI, add pins/DevRec/labels/floorplan, and export a GDS.\n    from pathlib import Path\n    import gdsfactory as gf\n    from gdsfactory.add_ports import add_ports_from_markers_center\n    from gdsfactory.read import import_gds\n    from gdsfactory.port import auto_rename_ports_orientation\n\n    if hasattr(gf, \"gpdk\") and hasattr(gf.gpdk, \"PDK\"):\n        gf.gpdk.PDK.activate()\n\n    # 1) Define the waveguide cross-section used for routing the MZI arms.\n    xs = gf.cross_section.strip(layer=(1, 0), width=0.5)\n    pdk_gds = Path(\n        \"SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_bdc_te1550.gds\"\n    )\n    # 2) Load the splitter PDK cell from the SiEPIC GDS and add ports from PinRec.\n    splitter = import_gds(pdk_gds, cellname=\"ebeam_bdc_te1550\")\n    add_ports_from_markers_center(splitter, pin_layer=(1, 10), port_layer=(1, 0))\n    auto_rename_ports_orientation(splitter)\n\n    # 3) Build the MZI by connecting two splitters with routed waveguide arms.\n    mzi = gf.components.mzi(\n        splitter=splitter,\n        combiner=splitter,\n        cross_section=xs,\n        port_e1_splitter=\"oE1\",\n        port_e0_splitter=\"oE0\",\n        port_e1_combiner=\"oE1\",\n        port_e0_combiner=\"oE0\",\n        delta_length=50.0,\n        length_x=60.0,\n        length_y=10.0,\n    )\n\n    gc_gds = Path(\n        \"SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_gc_te1550.gds\"\n    )\n    # 4) Load the grating coupler cell and add ports so we can connect to I/O.\n    gc = import_gds(gc_gds, cellname=\"ebeam_gc_te1550\")\n    add_ports_from_markers_center(gc, pin_layer=(1, 10), port_layer=(1, 0))\n    auto_rename_ports_orientation(gc)\n\n    def pick_port(component, orientation, *, fallback_first=False):\n        ports = component.ports\n        port_list = list(ports.values()) if hasattr(ports, \"values\") else list(ports)\n        for port in port_list:\n            if port.orientation is not None and int(round(port.orientation)) == orientation:\n                return port\n        if fallback_first and port_list:\n            return port_list[0]\n        raise ValueError(f\"No port with orientation {orientation} on {component.name}\")\n\n    # 5) Assemble the final layout by connecting two GCs to the MZI I/O ports.\n    c = gf.Component()\n    mzi_ref = c \u003C\u003C mzi\n    mzi_in = pick_port(mzi_ref, 180)\n    mzi_out = pick_port(mzi_ref, 0)\n    gc_port = pick_port(gc, 180, fallback_first=True)\n    gc_in = c \u003C\u003C gc\n    gc_in.connect(gc_port.name, mzi_in)\n    gc_out = c \u003C\u003C gc\n    gc_out.connect(gc_port.name, mzi_out)\n\n    # 6) Add PinRec markers on each external port (required by openEBL).\n    pin_layer = (1, 10)\n    pin_w = 2.0\n    pin_h = 1.0\n    for port in c.ports.values():\n        cx, cy = port.center\n        c.add_polygon(\n            [\n                (cx - pin_w / 2, cy - pin_h / 2),\n                (cx + pin_w / 2, cy - pin_h / 2),\n                (cx + pin_w / 2, cy + pin_h / 2),\n                (cx - pin_w / 2, cy + pin_h / 2),\n            ],\n            layer=pin_layer,\n        )\n\n    # 7) Add DevRec and Floorplan boxes around the full layout bbox.\n    xmin, ymin = c.bbox[0]\n    xmax, ymax = c.bbox[1]\n    pad = 5.0\n    c.add_polygon(\n        [\n            (xmin - pad, ymin - pad),\n            (xmax + pad, ymin - pad),\n            (xmax + pad, ymax + pad),\n            (xmin - pad, ymax + pad),\n        ],\n        layer=(68, 0),\n    )\n    c.add_polygon(\n        [\n            (xmin - pad, ymin - pad),\n            (xmax + pad, ymin - pad),\n            (xmax + pad, ymax + pad),\n            (xmin - pad, ymax + pad),\n        ],\n        layer=(99, 0),\n    )\n\n    # 8) Add Text labels for top cell and measurement tags.\n    c.add_label(text=\"TOP\", position=(xmin, ymax + 10.0), layer=(10, 0))\n    c.add_label(text=\"MZI\", position=(xmin, ymin - 10.0), layer=(10, 0))\n\n    # 9) Export a submission-ready GDS to the openEBL submissions folder.\n    out = Path(\"openEBL-2026-02/submissions/EBeam_username.gds\")\n    out.parent.mkdir(parents=True, exist_ok=True)\n    c.write_gds(out)\n    ```\n    \"\"\"\n).strip()\nmo.md(layout_code)", "code_hash": "c42136d9137b42139ac2e137660604f1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.stop(not show_targets)\n\nfrom _notebook_template import optional_import as optional_import_preview\n\ngf_preview = None\ngf_preview, gf_preview_error = optional_import_preview(\"gdsfactory\")\npreview_output = None\nif gf_preview is None:\n    preview_notice = [mo.md(\"Layout preview: `gdsfactory` is not available in this environment.\")]\n    if gf_preview_error:\n        preview_notice.append(mo.md(f\"Details: `{gf_preview_error}`\"))\n    preview_output = mo.vstack(preview_notice)\nelse:\n    try:\n        import pathlib as pathlib_preview\n        from gdsfactory.add_ports import add_ports_from_markers_center\n        from gdsfactory.read import import_gds\n        from gdsfactory.port import auto_rename_ports_orientation\n\n        if hasattr(gf_preview, \"gpdk\") and hasattr(gf_preview.gpdk, \"PDK\"):\n            gf_preview.gpdk.PDK.activate()\n\n        # Build the MZI layout from PDK cells and prepare a preview image.\n        xs = gf_preview.cross_section.strip(layer=(1, 0), width=0.5)\n        pdk_gds = pathlib_preview.Path(\n            \"SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_bdc_te1550.gds\"\n        )\n        if not pdk_gds.exists():\n            raise FileNotFoundError(f\"SiEPIC PDK GDS not found at {pdk_gds}\")\n\n        splitter = import_gds(pdk_gds, cellname=\"ebeam_bdc_te1550\")\n        add_ports_from_markers_center(splitter, pin_layer=(1, 10), port_layer=(1, 0))\n        auto_rename_ports_orientation(splitter)\n\n        # Route the MZI using the SiEPIC splitter for both couplers.\n        mzi = gf_preview.components.mzi(\n            splitter=splitter,\n            combiner=splitter,\n            cross_section=xs,\n            port_e1_splitter=\"oE1\",\n            port_e0_splitter=\"oE0\",\n            port_e1_combiner=\"oE1\",\n            port_e0_combiner=\"oE0\",\n            delta_length=50.0,\n            length_x=60.0,\n            length_y=10.0,\n        )\n\n        gc_gds = pathlib_preview.Path(\n            \"SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_gc_te1550.gds\"\n        )\n        if not gc_gds.exists():\n            raise FileNotFoundError(f\"SiEPIC PDK GDS not found at {gc_gds}\")\n        gc = import_gds(gc_gds, cellname=\"ebeam_gc_te1550\")\n        add_ports_from_markers_center(gc, pin_layer=(1, 10), port_layer=(1, 0))\n        auto_rename_ports_orientation(gc)\n\n        # Attach grating couplers to the MZI input and output.\n        def pick_port(component, orientation, *, fallback_first=False):\n            ports = component.ports\n            port_list = list(ports.values()) if hasattr(ports, \"values\") else list(ports)\n            for port in port_list:\n                if port.orientation is not None and int(round(port.orientation)) == orientation:\n                    return port\n            if fallback_first and port_list:\n                return port_list[0]\n            raise ValueError(f\"No port with orientation {orientation} on {component.name}\")\n\n        c = gf_preview.Component()\n        mzi_ref = c \u003C\u003C mzi\n        mzi_in = pick_port(mzi_ref, 180)\n        mzi_out = pick_port(mzi_ref, 0)\n        gc_port = pick_port(gc, 180, fallback_first=True)\n        gc_in = c \u003C\u003C gc\n        gc_in.connect(gc_port.name, mzi_in)\n        gc_out = c \u003C\u003C gc\n        gc_out.connect(gc_port.name, mzi_out)\n\n        # Render the layout as a PNG for display in the notebook.\n        fig = c.plot()\n        if fig is None:\n            import matplotlib.pyplot as plt\n            fig = plt.gcf()\n        from io import BytesIO\n\n        buf = BytesIO()\n        fig.savefig(buf, format=\"png\", bbox_inches=\"tight\")\n        buf.seek(0)\n        preview_output = mo.vstack(\n            [\n                mo.md(\"### Final rendering (complete MZI cell)\"),\n                mo.image(buf),\n            ]\n        )\n    except Exception as e:  # pragma: no cover\n        preview_output = mo.md(f\"(Could not build preview: `{type(e).__name__}: {e}`)\")\npreview_output", "code_hash": "738a31b6514ab4f48c008f2f2b9c91db", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "mo.stop(not show_targets)\nmo.md(r\"\"\"\n### Targets: pick \u0394L from an FSR target (1550 nm default)\n\nUse the Week 2 modelling notebook to build intuition and sanity-check values:\n`marimo_course/lessons/w02_mzi_modelling.py`.\n\nRule-of-thumb near \u03bb0:\n\n$$\n\\mathrm{FSR} \\approx \\frac{\\lambda_0^2}{n_g\\,\\Delta L}.\n$$\n\"\"\")\n\ndoc_callout_html(\n    \"info\",\n    tag=\"Tip\",\n    title=\"What matters for FSR\",\n    html=(\n        \"- \u0394L sets fringe spacing (FSR) approximately as `1/\u0394L`.\\n\"\n        \"- Base length doesn\u2019t change FSR in the ideal model.\\n\"\n        \"- Use **1550 nm** by default; treat **1310 nm** as an extension.\"\n    ),\n)", "code_hash": "5c719b8e6a3a49755e8830092ccd4da5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.stop(not show_targets)\nwl0_nm = mo.ui.number(value=1550.0, label=\"\u03bb0 (nm)\")\nng = mo.ui.number(value=4.19, label=\"ng (group index)\")\ndeltaL_um = mo.ui.number(value=50.0, label=\"Planned \u0394L (\u00b5m)\")\nmo.hstack([wl0_nm, ng, deltaL_um])", "code_hash": "ef2262bfa95644798bc6e0a8c4aeacf3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "mo.stop(not show_targets)\nwl0_um = float(wl0_nm.value) / 1e3\nng_val = float(ng.value)\ndelta_L_um = float(deltaL_um.value)\nfsr_nm = (\n    None\n    if (delta_L_um \u003C= 0 or ng_val \u003C= 0)\n    else (wl0_um * wl0_um) / (ng_val * delta_L_um) * 1e3\n)\nmo.md(\n    \"FSR estimate: (enter positive \u0394L and ng)\"\n    if fsr_nm is None\n    else f\"FSR estimate: **{fsr_nm:.2f} nm**\"\n)", "code_hash": "6bd6f3bc304912a37383b542b8874a93", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "mo.stop(not show_targets)\nmo.md(r\"\"\"\n### Notebook version of the openEBL pre-submission steps\n\nThese mirror the typical PDK workflow, but are implemented directly in Python.\nUse the toggles below to add required layers before exporting a GDS.\n\"\"\")", "code_hash": "384499b4a05c29676d00b40cf4806ebf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "mo.stop(not show_targets)\nadd_pins = mo.ui.checkbox(label=\"Add PinRec markers (1/10)\", value=True)\nadd_devrec = mo.ui.checkbox(label=\"Add DevRec box (68/0)\", value=True)\nadd_floorplan = mo.ui.checkbox(label=\"Add Floorplan box (99/0)\", value=False)\nadd_labels = mo.ui.checkbox(label=\"Add Text labels (10/0)\", value=True)\nexport_path = mo.ui.text(\n    value=\"openEBL-2026-02/submissions/EBeam_username.gds\",\n    label=\"Export path\",\n)\nmo.vstack(\n    [\n        mo.hstack([add_pins, add_devrec, add_floorplan, add_labels]),\n        export_path,\n    ]\n)", "code_hash": "19391acd13757f419b9612ed79160dd3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.stop(not show_targets)\n\nfrom _notebook_template import optional_import as optional_import_export\n\ngf_export = None\ngf_export, gf_export_error = optional_import_export(\"gdsfactory\")\nbuild_export_output = None\nif gf_export is None:\n    export_notice = [mo.md(\"Build/export: `gdsfactory` is not available in this environment.\")]\n    if gf_export_error:\n        export_notice.append(mo.md(f\"Details: `{gf_export_error}`\"))\n    build_export_output = mo.vstack(export_notice)\nelse:\n    try:\n        import pathlib as pathlib_export\n        from gdsfactory.add_ports import add_ports_from_markers_center as add_ports_export\n        from gdsfactory.read import import_gds as import_gds_export\n        from gdsfactory.port import auto_rename_ports_orientation as rename_ports_export\n\n        if hasattr(gf_export, \"gpdk\") and hasattr(gf_export.gpdk, \"PDK\"):\n            gf_export.gpdk.PDK.activate()\n\n        # Build the base MZI layout (same as preview) and then add submission layers.\n        xs_export = gf_export.cross_section.strip(layer=(1, 0), width=0.5)\n        pdk_gds_export = pathlib_export.Path(\n            \"SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_bdc_te1550.gds\"\n        )\n        if not pdk_gds_export.exists():\n            build_export_output = mo.md(\n                f\"(Build/export failed: SiEPIC splitter GDS not found at `{pdk_gds_export}`)\"\n            )\n        else:\n            # Load the splitter cell from the PDK and make sure ports are available.\n            splitter_export = import_gds_export(\n                pdk_gds_export,\n                cellname=\"ebeam_bdc_te1550\",\n                rename_duplicated_cells=True,\n            )\n            add_ports_export(splitter_export, pin_layer=(1, 10), port_layer=(1, 0))\n            rename_ports_export(splitter_export)\n            splitter_export.name = \"ebeam_bdc_te1550_splitter\"\n\n            mzi_export = gf_export.components.mzi(\n                splitter=splitter_export,\n                combiner=splitter_export,\n                cross_section=xs_export,\n                port_e1_splitter=\"oE1\",\n                port_e0_splitter=\"oE0\",\n                port_e1_combiner=\"oE1\",\n                port_e0_combiner=\"oE0\",\n                delta_length=50.0,\n                length_x=60.0,\n                length_y=10.0,\n            )\n\n            gc_gds_export = pathlib_export.Path(\n                \"SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_gc_te1550.gds\"\n            )\n            if not gc_gds_export.exists():\n                build_export_output = mo.md(\n                    f\"(Build/export failed: SiEPIC GC GDS not found at `{gc_gds_export}`)\"\n                )\n            else:\n                # Load the grating coupler cell for I/O.\n                gc_export = import_gds_export(\n                    gc_gds_export,\n                    cellname=\"ebeam_gc_te1550\",\n                    rename_duplicated_cells=True,\n                )\n                add_ports_export(gc_export, pin_layer=(1, 10), port_layer=(1, 0))\n                rename_ports_export(gc_export)\n                gc_export.name = \"ebeam_gc_te1550_gc\"\n\n                def pick_port_export(component, orientation, *, fallback_first=False):\n                    ports = component.ports\n                    port_list = (\n                        list(ports.values()) if hasattr(ports, \"values\") else list(ports)\n                    )\n                    for port in port_list:\n                        if port.orientation is not None and int(round(port.orientation)) == orientation:\n                            return port\n                    if fallback_first and port_list:\n                        return port_list[0]\n                    raise ValueError(\n                        f\"No port with orientation {orientation} on {component.name}\"\n                    )\n\n                # Assemble the final layout by connecting GCs to the MZI ports.\n                c_export = gf_export.Component()\n                mzi_ref_export = c_export \u003C\u003C mzi_export\n                mzi_in_export = pick_port_export(mzi_ref_export, 180)\n                mzi_out_export = pick_port_export(mzi_ref_export, 0)\n                gc_port_export = pick_port_export(gc_export, 180, fallback_first=True)\n                gc_in_export = c_export \u003C\u003C gc_export\n                gc_in_export.connect(gc_port_export.name, mzi_in_export)\n                gc_out_export = c_export \u003C\u003C gc_export\n                gc_out_export.connect(gc_port_export.name, mzi_out_export)\n\n                # Add PinRec markers for all external ports (required for openEBL).\n                if add_pins.value:\n                    pin_layer = (1, 10)\n                    pin_w = 2.0\n                    pin_h = 1.0\n                    ports = c_export.ports\n                    port_list = (\n                        list(ports.values()) if hasattr(ports, \"values\") else list(ports)\n                    )\n                    for port in port_list:\n                        cx, cy = port.center\n                        c_export.add_polygon(\n                            [\n                                (cx - pin_w / 2, cy - pin_h / 2),\n                                (cx + pin_w / 2, cy - pin_h / 2),\n                                (cx + pin_w / 2, cy + pin_h / 2),\n                                (cx - pin_w / 2, cy + pin_h / 2),\n                            ],\n                            layer=pin_layer,\n                        )\n\n                def get_bbox(component):\n                    bbox = component.bbox() if callable(getattr(component, \"bbox\", None)) else component.bbox\n                    if hasattr(bbox, \"left\"):\n                        return bbox.left, bbox.bottom, bbox.right, bbox.top\n                    if hasattr(bbox, \"__getitem__\"):\n                        (xmin, ymin), (xmax, ymax) = bbox[0], bbox[1]\n                        return xmin, ymin, xmax, ymax\n                    raise TypeError(\"Unsupported bbox type\")\n\n                # Add DevRec and optional Floorplan around the layout bbox.\n                if add_devrec.value or add_floorplan.value:\n                    xmin, ymin, xmax, ymax = get_bbox(c_export)\n                    pad = 5.0\n                    if add_devrec.value:\n                        c_export.add_polygon(\n                            [\n                                (xmin - pad, ymin - pad),\n                                (xmax + pad, ymin - pad),\n                                (xmax + pad, ymax + pad),\n                                (xmin - pad, ymax + pad),\n                            ],\n                            layer=(68, 0),\n                        )\n                    if add_floorplan.value:\n                        c_export.add_polygon(\n                            [\n                                (xmin - pad, ymin - pad),\n                                (xmax + pad, ymin - pad),\n                                (xmax + pad, ymax + pad),\n                                (xmin - pad, ymax + pad),\n                            ],\n                            layer=(99, 0),\n                        )\n\n                # Add Text labels for top-cell naming and identification.\n                if add_labels.value:\n                    xmin, ymin, xmax, ymax = get_bbox(c_export)\n                    c_export.add_label(\n                        text=\"TOP\",\n                        position=(xmin, ymax + 10.0),\n                        layer=(10, 0),\n                    )\n                    c_export.add_label(\n                        text=\"MZI\",\n                        position=(xmin, ymin - 10.0),\n                        layer=(10, 0),\n                    )\n\n                # Export the final GDS to the openEBL submissions folder.\n                out_export = pathlib_export.Path(str(export_path.value)).expanduser()\n                out_export.parent.mkdir(parents=True, exist_ok=True)\n                written_export = c_export.write_gds(out_export)\n                build_export_output = mo.vstack(\n                    [\n                        mo.md(f\"Wrote: `{written_export}`\"),\n                        mo.md(\n                            \"Reminder: verify the top-cell name and port labels in your layout viewer.\"\n                        ),\n                    ]\n                )\n    except Exception as e:  # pragma: no cover\n        build_export_output = mo.md(f\"(Build/export failed: `{type(e).__name__}: {e}`)\")\nbuild_export_output", "code_hash": "a8d0d392212b26a25e163b7f106169c7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "mo.stop(not show_skeleton)\nenable_gdsfactory = mo.ui.checkbox(\n    label=\"Enable gdsfactory helper (may take a while to import)\",\n    value=False,\n)\nenable_gdsfactory", "code_hash": "ae747f8c144c194cac28cb02aec8adce", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "mo.stop(not show_skeleton)\nfrom _notebook_template import optional_import as optional_import_skeleton\n\ngf_mod = None\navailable = False\nif not enable_gdsfactory.value:\n    msg = mo.md(\n        \"Optional gdsfactory helper: **disabled** (enable the checkbox to import)\"\n    )\nelse:\n    gf_mod, gf_error = optional_import_skeleton(\"gdsfactory\")\n    available = gf_mod is not None\n    msg = mo.md(\n        \"Optional gdsfactory helper: **available**\"\n        if available\n        else f\"Optional gdsfactory helper: **not available** (`{gf_error}`)\"\n    )\nmsg", "code_hash": "67c53ebbcd54d10485b61af25a52c31f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "mo.stop(not show_skeleton)\nmo.stop(not available)\n\n# Parameters for a quick, generic MZI skeleton export.\ngds_out = mo.ui.text(value=\"marimo_course/build/week2_mzi_skeleton.gds\", label=\"GDS output path\")\ndelta_length = mo.ui.number(value=50.0, label=\"\u0394L (\u00b5m)\")\nlength_x = mo.ui.number(value=60.0, label=\"length_x (\u00b5m)\")\nlength_y = mo.ui.number(value=10.0, label=\"length_y (\u00b5m)\")\nwrite = mo.ui.button(value=0, label=\"Write GDS\", kind=\"success\", on_click=lambda v: (v or 0) + 1)\nmo.vstack([mo.hstack([gds_out, write]), mo.hstack([delta_length, length_x, length_y])])", "code_hash": "387fc87a68bcacfcb79380b742018cc3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.stop(not show_skeleton)\nmo.stop(not available)\n\nfrom pathlib import Path\n\ndef write_mzi_skeleton(*, out: Path, delta_length_um: float, length_x_um: float, length_y_um: float) -\u003E Path:\n    gf = gf_mod\n    # Create a generic MZI to visualize geometry only (not PDK-accurate).\n    mzi = gf.components.mzi(\n        delta_length=float(delta_length_um),\n        length_x=float(length_x_um),\n        length_y=float(length_y_um),\n    )\n    out.parent.mkdir(parents=True, exist_ok=True)\n    written = mzi.write_gds(gdspath=out)\n    return Path(written)", "code_hash": "65a5ef8c316c8da9885fdc17aa254aed", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "mo.stop(not show_skeleton)\nmo.stop(not available)\n\nblocks = []\nif int(write.value or 0) \u003C= 0:\n    blocks.append(\n        mo.md(\"Click **Write GDS** to export a skeleton you can inspect in a layout viewer.\")\n    )\nelse:\n    out = Path(str(gds_out.value)).expanduser()\n    try:\n        # Write the skeleton GDS file and report the path.\n        written = write_mzi_skeleton(\n            out=out,\n            delta_length_um=float(delta_length.value),\n            length_x_um=float(length_x.value),\n            length_y_um=float(length_y.value),\n        )\n        blocks.append(mo.md(f\"Wrote: `{written}`\"))\n        blocks.append(mo.md(f\"Open in your layout viewer: `{written}`\"))\n    except Exception as e:  # pragma: no cover\n        blocks.append(mo.md(f\"(GDS write failed: `{type(e).__name__}: {e}`)\"))\n\nmo.vstack(blocks)", "code_hash": "761a2eb378ef52e296364b1fe9beccd6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "mo.stop(not show_submission)\nmo.md(r\"\"\"\n\u003Ca id=\"submission\"\u003E\u003C/a\u003E\n## Save + submission workflow (openEBL)\n\nThe details depend on the specific openEBL run repository used this semester, but the structure is consistent:\nsave designs in the right folder, run checks, fix failures, and submit via PR.\n\"\"\")\n\ndoc_callout_list(\n    \"info\",\n    tag=\"Checklist\",\n    title=\"Before you push\",\n    ordered=True,\n    items=[\n        \"Confirm your layout file is inside the run repo (e.g., `openEBL-2026-02/submissions/...`).\",\n        \"Verify naming conventions and top-level cell structure match the run instructions.\",\n        \"Run local verification in your layout viewer if available.\",\n        \"Push to your fork and check GitHub Actions results; download artifacts when something fails.\",\n    ],\n)", "code_hash": "95111beee4c6cb8dcdcbe7bbf148f78c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "session": {"cells": [{"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "6cb978e63f2955e2bd66085ab06248fe", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cstyle\u003E\n  :root {\n    --doc-max: 920px;\n    --doc-muted: color-mix(in srgb, currentColor 65%, transparent);\n    --doc-border: color-mix(in srgb, currentColor 18%, transparent);\n    --doc-accent: #2563eb;\n    --doc-bg: color-mix(in srgb, currentColor 3%, transparent);\n  }\n\n  /* \"Docs-like\" typography + width */\n  .markdown.prose,\n  .markdown.prose \u003E :is(h1,h2,h3,h4,h5,h6,p,ul,ol,pre,blockquote,table,hr,div) {\n    max-width: var(--doc-max);\n  }\n  .markdown.prose { padding-right: 1rem; }\n  .markdown.prose :is(h1,h2,h3) { letter-spacing: -0.01em; }\n  .markdown.prose a { color: var(--doc-accent); text-decoration: none; }\n  .markdown.prose a:hover { text-decoration: underline; }\n  .markdown.prose code {\n    background: var(--doc-bg);\n    padding: 0.12rem 0.28rem;\n    border-radius: 0.3rem;\n  }\n  .markdown.prose pre code { background: transparent; padding: 0; }\n  .markdown.prose pre {\n    border: 1px solid var(--doc-border);\n    border-radius: 0.7rem;\n    padding: 0.9rem 1rem;\n    overflow: auto;\n  }\n\n  .doc-hero {\n    max-width: var(--doc-max);\n    border: 1px solid var(--doc-border);\n    border-radius: 1rem;\n    padding: 1.2rem 1.2rem 0.9rem 1.2rem;\n    background: linear-gradient(\n      180deg,\n      color-mix(in srgb, var(--doc-accent) 10%, transparent),\n      transparent\n    );\n  }\n  .doc-hero h1 { margin: 0.2rem 0 0.4rem 0; }\n  .doc-hero p { margin: 0.2rem 0 0.8rem 0; color: var(--doc-muted); }\n  .doc-badges { display: flex; gap: 0.5rem; flex-wrap: wrap; margin: 0.2rem 0; }\n  .doc-badge {\n    border: 1px solid var(--doc-border);\n    border-radius: 999px;\n    padding: 0.15rem 0.55rem;\n    font-size: 0.85rem;\n    background: color-mix(in srgb, currentColor 2%, transparent);\n  }\n  .doc-toc {\n    max-width: var(--doc-max);\n    border: 1px solid var(--doc-border);\n    border-radius: 0.9rem;\n    padding: 0.8rem 1rem;\n    background: color-mix(in srgb, currentColor 1%, transparent);\n  }\n  .doc-toc ul { margin: 0.4rem 0 0 1.2rem; }\n\n  /* Standard callouts */\n  .callout {\n    max-width: var(--doc-max);\n    border: 1px solid var(--doc-border);\n    border-radius: 0.9rem;\n    padding: 0.85rem 1rem;\n    margin: 0.9rem 0;\n    background: color-mix(in srgb, currentColor 1%, transparent);\n  }\n  .callout-title {\n    display: flex;\n    align-items: center;\n    gap: 0.55rem;\n    font-weight: 700;\n    margin-bottom: 0.35rem;\n  }\n  .callout-title .tag {\n    font-size: 0.8rem;\n    border: 1px solid var(--doc-border);\n    border-radius: 999px;\n    padding: 0.1rem 0.5rem;\n    color: var(--doc-muted);\n    font-weight: 600;\n  }\n  .callout.info { border-left: 5px solid #2563eb; }\n  .callout.warning { border-left: 5px solid #b45309; }\n  .callout.exercise { border-left: 5px solid #059669; }\n\n  /* Slightly more compact widgets (sliders/buttons/inputs) */\n  label, input, select, textarea, button {\n    font-size: 0.92rem;\n  }\n\n  @media (max-width: 980px) {\n    .markdown.prose { padding-right: 1rem; }\n  }\n\u003C/style\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "05080628ac7431f1b8289de5a4735a5a", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8077ff33f74ee007b76293449a272126", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='bkHC-5' random-id='2d4dd501-327f-8e85-4620-443081425b90'\u003E\u003Cmarimo-tabs data-initial-value='\u0026quot;0\u0026quot;' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Notebook sections\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-tabs='[\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;All\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;,\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Overview\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;,\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Build MZI + Targets\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;,\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Layout skeleton\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;,\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Submission\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;]'\u003E\u003Cdiv data-kind='tab'\u003E\u003Cmarimo-ui-element object-id='bkHC-0' random-id='10ccedd9-33db-0429-7ebc-ef253b4f43cc'\u003E\u003Cmarimo-lazy data-initial-value='false' data-label='null' data-show-loading-indicator='false'\u003E\u003C/marimo-lazy\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003Cdiv data-kind='tab'\u003E\u003Cmarimo-ui-element object-id='bkHC-1' random-id='e17af21e-530b-0d2b-5f14-f2e68358c301'\u003E\u003Cmarimo-lazy data-initial-value='false' data-label='null' data-show-loading-indicator='false'\u003E\u003C/marimo-lazy\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003Cdiv data-kind='tab'\u003E\u003Cmarimo-ui-element object-id='bkHC-2' random-id='ae56136f-c176-ad1d-028c-4406f141ff8a'\u003E\u003Cmarimo-lazy data-initial-value='false' data-label='null' data-show-loading-indicator='false'\u003E\u003C/marimo-lazy\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003Cdiv data-kind='tab'\u003E\u003Cmarimo-ui-element object-id='bkHC-3' random-id='0e7a0cde-9ef5-29b2-1844-127aa1aef9a7'\u003E\u003Cmarimo-lazy data-initial-value='false' data-label='null' data-show-loading-indicator='false'\u003E\u003C/marimo-lazy\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003Cdiv data-kind='tab'\u003E\u003Cmarimo-ui-element object-id='bkHC-4' random-id='246b403f-cfde-8441-5ee0-d2fe3670f8ca'\u003E\u003Cmarimo-lazy data-initial-value='false' data-label='null' data-show-loading-indicator='false'\u003E\u003C/marimo-lazy\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003C/marimo-tabs\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "b0abf07445f0a98d54b88f3481c92e4f", "console": [], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9091f5bf6f4ffe6d2e2aa6ff2e9cc932", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cdiv class=\"doc-badges\"\u003E\u003Cspan class=\"doc-badge\"\u003ENotebook view: \u003Cstrong\u003EAll\u003C/strong\u003E\u003C/span\u003E\u003C/div\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4523f87c7387dd7cac99eaa1ff5b7a6f", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cdiv class=\"doc-hero\"\u003E\n      \u003Cdiv class=\"doc-badges\"\u003E\n        \u003Cspan class=\"doc-badge\"\u003EWeek 2\u003C/span\u003E\n\u003Cspan class=\"doc-badge\"\u003ELab companion\u003C/span\u003E\n\u003Cspan class=\"doc-badge\"\u003EPDK\u003C/span\u003E\n\u003Cspan class=\"doc-badge\"\u003EopenEBL workflow\u003C/span\u003E\n      \u003C/div\u003E\n      \u003Ch1\u003EPDK MZI layout (SiEPIC PDK)\u003C/h1\u003E\n      \u003Cspan class=\"paragraph\"\u003EBuild a first MZI layout using the SiEPIC-EBeam PDK workflow in Python. Use modelling targets (\u0394L \u2194 FSR) to guide geometry choices, then save your work in the openEBL repo.\u003C/span\u003E\n      \u003Cspan class=\"paragraph\"\u003E\u003Csmall\u003E\u003Cem\u003ENotebook build: 2025-12-16\u003C/em\u003E\u003C/small\u003E\u003C/span\u003E\n    \u003C/div\u003E\u003C/span\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cdiv class=\"doc-toc\"\u003E\n      \u003Cstrong\u003EOn this page\u003C/strong\u003E\n      \u003Cul\u003E\n        \u003Cli\u003E\u003Ca href=\"#overview\"\u003EOverview\u003C/a\u003E\u003C/li\u003E\u003C/span\u003E\n\u003Cli\u003E\u003Ca href=\"#targets\"\u003EBuild MZI + Targets\u003C/a\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ca href=\"#skeleton\"\u003ELayout skeleton\u003C/a\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ca href=\"#submission\"\u003ESubmission\u003C/a\u003E\u003C/li\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003C/ul\u003E\n    \u003C/div\u003E\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "903bc994fcff9499e6e071600be2ec3d", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Ca id=\"overview\"\u003E\u003C/a\u003E\u003C/span\u003E\n\u003Ch2 id=\"overview\"\u003EOverview\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EThis is the \u003Cstrong\u003EPDK + compact-model + layout\u003C/strong\u003E companion for Week 2. The modelling companion is:\n\u003Ccode\u003Emarimo_course/lessons/w02_mzi_modelling.py\u003C/code\u003E, where you derived and explored the ideal MZI transfer function.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EIn this notebook, you'll connect three ideas that show up in every photonics workflow:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003ECompact models:\u003C/strong\u003E fast, circuit-level models of components (couplers, waveguides, phase shifters) that let you\n  simulate a whole photonic circuit without solving Maxwell's equations everywhere.\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EPDK (process design kit):\u003C/strong\u003E a foundry/technology \"package\" that defines the \u003Cstrong\u003Edesign rules\u003C/strong\u003E, \u003Cstrong\u003Elayers\u003C/strong\u003E, and\n  \u003Cstrong\u003Eparameterized building blocks\u003C/strong\u003E (plus their compact models) so your design is manufacturable and checkable.\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EReproducibility across views:\u003C/strong\u003E build the \u003Cem\u003Esame\u003C/em\u003E MZI you modelled last lesson, first as a \u003Cstrong\u003Ecircuit\u003C/strong\u003E from compact\n  models and then as a \u003Cstrong\u003Elayout\u003C/strong\u003E using PDK cells.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EIn lab, you will:\u003C/span\u003E\n\u003Col\u003E\n\u003Cli\u003EBuild an MZI from \u003Cstrong\u003Ecompact models\u003C/strong\u003E (component \u2192 circuit) and sanity-check it against the Week 2 model.\u003C/li\u003E\n\u003Cli\u003EDecide on a \u003Cstrong\u003Etarget\u003C/strong\u003E (FSR \u2192 \u0394L) near \u003Cstrong\u003E1550 nm\u003C/strong\u003E.\u003C/li\u003E\n\u003Cli\u003EAssemble the same MZI from \u003Cstrong\u003EPDK building blocks\u003C/strong\u003E (splitter, waveguides, combiner, I/O).\u003C/li\u003E\n\u003Cli\u003EAdd the \u003Cstrong\u003Econventions\u003C/strong\u003E required for downstream checks (ports/pins, DevRec, labels/floorplan as required).\u003C/li\u003E\n\u003Cli\u003ESave your design in the \u003Cstrong\u003EopenEBL\u003C/strong\u003E submission repo and keep CI green.\u003C/li\u003E\n\u003C/ol\u003E\u003C/span\u003E\u003Cmarimo-callout-output data-html='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Learning goals:\u0026lt;/strong\u0026gt; What you should be able to do after this notebook\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;- Explain what a compact model is and why we use them for circuit-level photonics design.\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;ul\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Describe what a PDK provides (layers, rules, cells, models) and why it matters for manufacturable layouts.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Create an MZI from compact-model building blocks and connect \u0394L \u2194 FSR back to the modelling notebook.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Implement the same MZI using PDK-accurate cells so it passes downstream checks.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;/ul\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;info\u0026quot;'\u003E\u003C/marimo-callout-output\u003E\u003Cmarimo-callout-output data-html='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Where is the graded work?:\u0026lt;/strong\u0026gt; Lab companion vs homework\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;- This notebook is a lab companion (workflow + checklists + reference).\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;ul\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Graded work should live in a homework notebook under \u0026lt;code\u0026gt;marimo_course/assignments/\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;/ul\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;warn\u0026quot;'\u003E\u003C/marimo-callout-output\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "e8e637d0de05e1215d78f1fd990ac272", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-ui-element object-id='BYtC-0' random-id='f9edc1f0-a2aa-4868-62cc-885324561b76'\u003E\u003Cmarimo-checkbox data-initial-value='false' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Placed I/O + splitter/combiner cells\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='BYtC-1' random-id='4a3fa1a4-0a55-fce0-693e-16e2d4803175'\u003E\u003Cmarimo-checkbox data-initial-value='false' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Routed an MZI skeleton with \u0394L\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='BYtC-2' random-id='5a0b7253-ec38-2960-d4d7-d7d12549cda4'\u003E\u003Cmarimo-checkbox data-initial-value='false' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Added pins/DevRec/labels as required\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='BYtC-3' random-id='818cc9b6-1dc5-8e84-7e6b-b25ff0627333'\u003E\u003Cmarimo-checkbox data-initial-value='false' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Saved in openEBL repo + CI checked\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "9e990b2339cd07f20aa9617979251f56", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: row;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 1rem'\u003E\u003Cmarimo-ui-element object-id='RGSE-0' random-id='1cb6a952-983a-70c6-a315-a48235fe9be7'\u003E\u003Cmarimo-button data-initial-value='0' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Go to Build MZI + Targets\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;success\u0026quot;' data-disabled='false' data-full-width='false'\u003E\u003C/marimo-button\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='RGSE-1' random-id='daf92bfa-daa4-3ba8-f121-d715551aa770'\u003E\u003Cmarimo-button data-initial-value='0' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Go to Layout skeleton\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;neutral\u0026quot;' data-disabled='false' data-full-width='false'\u003E\u003C/marimo-button\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='RGSE-2' random-id='7eae2f81-c00a-8eac-d702-28fd56236b5a'\u003E\u003Cmarimo-button data-initial-value='0' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Go to Submission\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;neutral\u0026quot;' data-disabled='false' data-full-width='false'\u003E\u003C/marimo-button\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "f5a7bdf5663d639797b06501cdc57193", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Ca id=\"targets\"\u003E\u003C/a\u003E\u003C/span\u003E\n\u003Ch2 id=\"build-the-mzi-targets\"\u003EBuild the MZI + targets\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EBuild the MZI from PDK components, render the layout, and then pick a \u0394L that\nmatches your target FSR near 1550 nm.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c42136d9137b42139ac2e137660604f1", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cdiv class=\"language-python codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003E\u003Cspan class=\"c1\"\u003E# Build MZI, add pins/DevRec/labels/floorplan, and export a GDS.\u003C/span\u003E\n\u003Cspan class=\"kn\"\u003Efrom\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Epathlib\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E \u003Cspan class=\"n\"\u003EPath\u003C/span\u003E\n\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Egdsfactory\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eas\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Egf\u003C/span\u003E\n\u003Cspan class=\"kn\"\u003Efrom\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Egdsfactory.add_ports\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E \u003Cspan class=\"n\"\u003Eadd_ports_from_markers_center\u003C/span\u003E\n\u003Cspan class=\"kn\"\u003Efrom\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Egdsfactory.read\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E \u003Cspan class=\"n\"\u003Eimport_gds\u003C/span\u003E\n\u003Cspan class=\"kn\"\u003Efrom\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Egdsfactory.port\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E \u003Cspan class=\"n\"\u003Eauto_rename_ports_orientation\u003C/span\u003E\n\n\u003Cspan class=\"k\"\u003Eif\u003C/span\u003E \u003Cspan class=\"nb\"\u003Ehasattr\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egf\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"s2\"\u003E\u0026quot;gpdk\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eand\u003C/span\u003E \u003Cspan class=\"nb\"\u003Ehasattr\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egf\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Egpdk\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"s2\"\u003E\u0026quot;PDK\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E):\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Egf\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Egpdk\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003EPDK\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eactivate\u003C/span\u003E\u003Cspan class=\"p\"\u003E()\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# 1) Define the waveguide cross-section used for routing the MZI arms.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Exs\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Egf\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecross_section\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Estrip\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Elayer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E \u003Cspan class=\"n\"\u003Ewidth\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"mf\"\u003E0.5\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Epdk_gds\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003EPath\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\n    \u003Cspan class=\"s2\"\u003E\u0026quot;SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_bdc_te1550.gds\u0026quot;\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"c1\"\u003E# 2) Load the splitter PDK cell from the SiEPIC GDS and add ports from PinRec.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Esplitter\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Eimport_gds\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Epdk_gds\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecellname\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;ebeam_bdc_te1550\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Eadd_ports_from_markers_center\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Esplitter\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_layer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E10\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport_layer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E))\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Eauto_rename_ports_orientation\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Esplitter\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# 3) Build the MZI by connecting two splitters with routed waveguide arms.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Emzi\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Egf\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecomponents\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Emzi\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Esplitter\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"n\"\u003Esplitter\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Ecombiner\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"n\"\u003Esplitter\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Ecross_section\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"n\"\u003Exs\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Eport_e1_splitter\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;oE1\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Eport_e0_splitter\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;oE0\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Eport_e1_combiner\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;oE1\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Eport_e0_combiner\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;oE0\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Edelta_length\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"mf\"\u003E50.0\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Elength_x\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"mf\"\u003E60.0\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Elength_y\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"mf\"\u003E10.0\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\n\u003Cspan class=\"n\"\u003Egc_gds\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003EPath\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\n    \u003Cspan class=\"s2\"\u003E\u0026quot;SiEPIC_EBeam_PDK_public/klayout/EBeam/gds/EBeam/ebeam_gc_te1550.gds\u0026quot;\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"c1\"\u003E# 4) Load the grating coupler cell and add ports so we can connect to I/O.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Egc\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Eimport_gds\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egc_gds\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecellname\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;ebeam_gc_te1550\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Eadd_ports_from_markers_center\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egc\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_layer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E10\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport_layer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E))\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Eauto_rename_ports_orientation\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egc\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\n\u003Cspan class=\"k\"\u003Edef\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nf\"\u003Epick_port\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecomponent\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eorientation\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"o\"\u003E*\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Efallback_first\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"kc\"\u003EFalse\u003C/span\u003E\u003Cspan class=\"p\"\u003E):\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Eports\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecomponent\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eports\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Eport_list\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"nb\"\u003Elist\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Eports\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Evalues\u003C/span\u003E\u003Cspan class=\"p\"\u003E())\u003C/span\u003E \u003Cspan class=\"k\"\u003Eif\u003C/span\u003E \u003Cspan class=\"nb\"\u003Ehasattr\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Eports\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"s2\"\u003E\u0026quot;values\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E \u003Cspan class=\"k\"\u003Eelse\u003C/span\u003E \u003Cspan class=\"nb\"\u003Elist\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Eports\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n    \u003Cspan class=\"k\"\u003Efor\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport\u003C/span\u003E \u003Cspan class=\"ow\"\u003Ein\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport_list\u003C/span\u003E\u003Cspan class=\"p\"\u003E:\u003C/span\u003E\n        \u003Cspan class=\"k\"\u003Eif\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eorientation\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eis\u003C/span\u003E \u003Cspan class=\"ow\"\u003Enot\u003C/span\u003E \u003Cspan class=\"kc\"\u003ENone\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eand\u003C/span\u003E \u003Cspan class=\"nb\"\u003Eint\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"nb\"\u003Eround\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Eport\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eorientation\u003C/span\u003E\u003Cspan class=\"p\"\u003E))\u003C/span\u003E \u003Cspan class=\"o\"\u003E==\u003C/span\u003E \u003Cspan class=\"n\"\u003Eorientation\u003C/span\u003E\u003Cspan class=\"p\"\u003E:\u003C/span\u003E\n            \u003Cspan class=\"k\"\u003Ereturn\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport\u003C/span\u003E\n    \u003Cspan class=\"k\"\u003Eif\u003C/span\u003E \u003Cspan class=\"n\"\u003Efallback_first\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eand\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport_list\u003C/span\u003E\u003Cspan class=\"p\"\u003E:\u003C/span\u003E\n        \u003Cspan class=\"k\"\u003Ereturn\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport_list\u003C/span\u003E\u003Cspan class=\"p\"\u003E[\u003C/span\u003E\u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E]\u003C/span\u003E\n    \u003Cspan class=\"k\"\u003Eraise\u003C/span\u003E \u003Cspan class=\"ne\"\u003EValueError\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"sa\"\u003Ef\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;No port with orientation \u003C/span\u003E\u003Cspan class=\"si\"\u003E{\u003C/span\u003E\u003Cspan class=\"n\"\u003Eorientation\u003C/span\u003E\u003Cspan class=\"si\"\u003E}\u003C/span\u003E\u003Cspan class=\"s2\"\u003E on \u003C/span\u003E\u003Cspan class=\"si\"\u003E{\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecomponent\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ename\u003C/span\u003E\u003Cspan class=\"si\"\u003E}\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# 5) Assemble the final layout by connecting two GCs to the MZI I/O ports.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Ec\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Egf\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003EComponent\u003C/span\u003E\u003Cspan class=\"p\"\u003E()\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Emzi_ref\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Ec\u003C/span\u003E \u003Cspan class=\"o\"\u003E\u0026lt;\u0026lt;\u003C/span\u003E \u003Cspan class=\"n\"\u003Emzi\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Emzi_in\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Epick_port\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Emzi_ref\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E180\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Emzi_out\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Epick_port\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Emzi_ref\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Egc_port\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Epick_port\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egc\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E180\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Efallback_first\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Egc_in\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Ec\u003C/span\u003E \u003Cspan class=\"o\"\u003E\u0026lt;\u0026lt;\u003C/span\u003E \u003Cspan class=\"n\"\u003Egc\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Egc_in\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Econnect\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egc_port\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ename\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Emzi_in\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Egc_out\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Ec\u003C/span\u003E \u003Cspan class=\"o\"\u003E\u0026lt;\u0026lt;\u003C/span\u003E \u003Cspan class=\"n\"\u003Egc\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Egc_out\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Econnect\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Egc_port\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ename\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Emzi_out\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# 6) Add PinRec markers on each external port (required by openEBL).\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Epin_layer\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E10\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Epin_w\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"mf\"\u003E2.0\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Epin_h\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"mf\"\u003E1.0\u003C/span\u003E\n\u003Cspan class=\"k\"\u003Efor\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport\u003C/span\u003E \u003Cspan class=\"ow\"\u003Ein\u003C/span\u003E \u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eports\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Evalues\u003C/span\u003E\u003Cspan class=\"p\"\u003E():\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Ecx\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecy\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Eport\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecenter\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eadd_polygon\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E[\u003C/span\u003E\n            \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecx\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_w\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecy\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_h\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n            \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecx\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_w\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecy\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_h\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n            \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecx\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_w\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecy\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_h\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n            \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecx\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_w\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ecy\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epin_h\u003C/span\u003E \u003Cspan class=\"o\"\u003E/\u003C/span\u003E \u003Cspan class=\"mi\"\u003E2\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E],\u003C/span\u003E\n        \u003Cspan class=\"n\"\u003Elayer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"n\"\u003Epin_layer\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# 7) Add DevRec and Floorplan boxes around the full layout bbox.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Exmin\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymin\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ebbox\u003C/span\u003E\u003Cspan class=\"p\"\u003E[\u003C/span\u003E\u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E]\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Exmax\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymax\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ebbox\u003C/span\u003E\u003Cspan class=\"p\"\u003E[\u003C/span\u003E\u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E]\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Epad\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"mf\"\u003E5.0\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eadd_polygon\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\n    \u003Cspan class=\"p\"\u003E[\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n    \u003Cspan class=\"p\"\u003E],\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Elayer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E68\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eadd_polygon\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\n    \u003Cspan class=\"p\"\u003E[\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"n\"\u003Epad\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n    \u003Cspan class=\"p\"\u003E],\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Elayer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E99\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# 8) Add Text labels for top cell and measurement tags.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eadd_label\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Etext\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;TOP\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eposition\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmin\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymax\u003C/span\u003E \u003Cspan class=\"o\"\u003E+\u003C/span\u003E \u003Cspan class=\"mf\"\u003E10.0\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E \u003Cspan class=\"n\"\u003Elayer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E10\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E))\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eadd_label\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Etext\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;MZI\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eposition\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Exmin\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eymin\u003C/span\u003E \u003Cspan class=\"o\"\u003E-\u003C/span\u003E \u003Cspan class=\"mf\"\u003E10.0\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E \u003Cspan class=\"n\"\u003Elayer\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E10\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E))\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# 9) Export a submission-ready GDS to the openEBL submissions folder.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Eout\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003EPath\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;openEBL-2026-02/submissions/EBeam_username.gds\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Eout\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eparent\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Emkdir\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Eparents\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eexist_ok\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Ec\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ewrite_gds\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Eout\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "738a31b6514ab4f48c008f2f2b9c91db", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ELayout preview: \u003Ccode\u003Egdsfactory\u003C/code\u003E is not available in this environment.\u003C/span\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EDetails: \u003Ccode\u003EModuleNotFoundError: No module named 'gdsfactory'\u003C/code\u003E\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "5c719b8e6a3a49755e8830092ccd4da5", "console": [], "id": "nWHF", "outputs": [{"data": {"text/html": "\u003Cmarimo-callout-output data-html='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Tip:\u0026lt;/strong\u0026gt; What matters for FSR\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;- \u0394L sets fringe spacing (FSR) approximately as \u0026lt;code\u0026gt;1/\u0394L\u0026lt;/code\u0026gt;.\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;ul\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Base length doesn\u2019t change FSR in the ideal model.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Use \u0026lt;strong\u0026gt;1550 nm\u0026lt;/strong\u0026gt; by default; treat \u0026lt;strong\u0026gt;1310 nm\u0026lt;/strong\u0026gt; as an extension.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;/ul\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;info\u0026quot;'\u003E\u003C/marimo-callout-output\u003E"}, "type": "data"}]}, {"code_hash": "ef2262bfa95644798bc6e0a8c4aeacf3", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: row;justify-content: space-between;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-ui-element object-id='iLit-0' random-id='08c1fe31-2945-61e7-173b-28f624b244c2'\u003E\u003Cmarimo-number data-initial-value='1550.0' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\u03bb0 (nm)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-debounce='false' data-full-width='false' data-disabled='false'\u003E\u003C/marimo-number\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='iLit-1' random-id='14bdaa74-05d3-5b49-3e5d-15a780e758a4'\u003E\u003Cmarimo-number data-initial-value='4.19' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;ng (group index)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-debounce='false' data-full-width='false' data-disabled='false'\u003E\u003C/marimo-number\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='iLit-2' random-id='941bab0f-ca5b-c792-e50e-c2f52452d7e3'\u003E\u003Cmarimo-number data-initial-value='50.0' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Planned \u0394L (\u00b5m)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-debounce='false' data-full-width='false' data-disabled='false'\u003E\u003C/marimo-number\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "6bd6f3bc304912a37383b542b8874a93", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EFSR estimate: \u003Cstrong\u003E11.47 nm\u003C/strong\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "384499b4a05c29676d00b40cf4806ebf", "console": [], "id": "ROlb", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"notebook-version-of-the-openebl-pre-submission-steps\"\u003ENotebook version of the openEBL pre-submission steps\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EThese mirror the typical PDK workflow, but are implemented directly in Python.\nUse the toggles below to add required layers before exporting a GDS.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "19391acd13757f419b9612ed79160dd3", "console": [], "id": "qnkX", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cdiv style='display: flex;flex: 1;flex-direction: row;justify-content: space-between;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-ui-element object-id='qnkX-0' random-id='ddf89500-67aa-6437-137c-76b9f364c6ab'\u003E\u003Cmarimo-checkbox data-initial-value='true' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Add PinRec markers (1/10)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='qnkX-1' random-id='dd295908-cec4-dddd-8965-a11c01320f09'\u003E\u003Cmarimo-checkbox data-initial-value='true' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Add DevRec box (68/0)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='qnkX-2' random-id='e6cf5088-c164-85b1-8884-e71435eac7dd'\u003E\u003Cmarimo-checkbox data-initial-value='false' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Add Floorplan box (99/0)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='qnkX-3' random-id='db7a50d3-985c-90f5-53a8-688517195716'\u003E\u003Cmarimo-checkbox data-initial-value='true' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Add Text labels (10/0)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003Cmarimo-ui-element object-id='qnkX-4' random-id='c1d5de56-989c-d467-7849-4f7cfd992acd'\u003E\u003Cmarimo-text data-initial-value='\u0026quot;openEBL-2026-02/submissions/EBeam_username.gds\u0026quot;' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Export path\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-placeholder='\u0026quot;\u0026quot;' data-kind='\u0026quot;text\u0026quot;' data-full-width='false' data-disabled='false' data-debounce='true'\u003E\u003C/marimo-text\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "a8d0d392212b26a25e163b7f106169c7", "console": [], "id": "TqIu", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EBuild/export: \u003Ccode\u003Egdsfactory\u003C/code\u003E is not available in this environment.\u003C/span\u003E\u003C/span\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EDetails: \u003Ccode\u003EModuleNotFoundError: No module named 'gdsfactory'\u003C/code\u003E\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "ae747f8c144c194cac28cb02aec8adce", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='Vxnm-0' random-id='3d091635-be87-f6bf-76f5-f9376b3ed935'\u003E\u003Cmarimo-checkbox data-initial-value='false' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Enable gdsfactory helper (may take a while to import)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "67c53ebbcd54d10485b61af25a52c31f", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EOptional gdsfactory helper: \u003Cstrong\u003Edisabled\u003C/strong\u003E (enable the checkbox to import)\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "387fc87a68bcacfcb79380b742018cc3", "console": [], "id": "ulZA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "65a5ef8c316c8da9885fdc17aa254aed", "console": [], "id": "ecfG", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "761a2eb378ef52e296364b1fe9beccd6", "console": [], "id": "Pvdt", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "95111beee4c6cb8dcdcbe7bbf148f78c", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/html": "\u003Cmarimo-callout-output data-html='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Checklist:\u0026lt;/strong\u0026gt; Before you push\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;1. Confirm your layout file is inside the run repo (e.g., \u0026lt;code\u0026gt;openEBL-2026-02/submissions/...\u0026lt;/code\u0026gt;).\u0026lt;/span\u0026gt;\u0026#92;n\u0026lt;ol\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Verify naming conventions and top-level cell structure match the run instructions.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Run local verification in your layout viewer if available.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;li\u0026gt;Push to your fork and check GitHub Actions results; download artifacts when something fails.\u0026lt;/li\u0026gt;\u0026#92;n\u0026lt;/ol\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;info\u0026quot;'\u003E\u003C/marimo-callout-output\u003E"}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.4%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20from%20_notebook_template%20import%20inject_css%0A%0A%20%20%20%20inject_css(mo)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20from%20_notebook_template%20import%20make_doc_helpers%0A%0A%20%20%20%20doc_badges%2C%20doc_callout_html%2C%20doc_callout_list%20%3D%20make_doc_helpers(mo)%0A%20%20%20%20return%20doc_badges%2C%20doc_callout_html%2C%20doc_callout_list%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20from%20_notebook_template%20import%20make_section_tabs%0A%0A%20%20%20%20section_tabs%2C%20view_state%2C%20set_view%20%3D%20make_section_tabs(%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20options%3D(%22All%22%2C%20%22Overview%22%2C%20%22Build%20MZI%20%2B%20Targets%22%2C%20%22Layout%20skeleton%22%2C%20%22Submission%22)%2C%0A%20%20%20%20%20%20%20%20value%3D%22All%22%2C%0A%20%20%20%20)%0A%20%20%20%20section_tabs%0A%20%20%20%20return%20set_view%2C%20view_state%0A%0A%0A%40app.cell%0Adef%20_(view_state)%3A%0A%20%20%20%20view%20%3D%20view_state()%0A%20%20%20%20show_overview%20%3D%20view%20in%20%5B%22All%22%2C%20%22Overview%22%5D%0A%20%20%20%20show_targets%20%3D%20view%20in%20%5B%22All%22%2C%20%22Build%20MZI%20%2B%20Targets%22%5D%0A%20%20%20%20show_skeleton%20%3D%20view%20in%20%5B%22All%22%2C%20%22Layout%20skeleton%22%5D%0A%20%20%20%20show_submission%20%3D%20view%20in%20%5B%22All%22%2C%20%22Submission%22%5D%0A%20%20%20%20return%20show_overview%2C%20show_skeleton%2C%20show_submission%2C%20show_targets%2C%20view%0A%0A%0A%40app.cell%0Adef%20_(doc_badges%2C%20view)%3A%0A%20%20%20%20doc_badges(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22Notebook%20view%3A%20%3Cstrong%3E%7Bview%7D%3C%2Fstrong%3E%22%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_overview)%3A%0A%20%20%20%20mo.stop(not%20show_overview)%0A%20%20%20%20from%20_style%20import%20header%0A%0A%20%20%20%20header(%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20title%3D%22PDK%20MZI%20layout%20(SiEPIC%20PDK)%22%2C%0A%20%20%20%20%20%20%20%20subtitle%3D(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Build%20a%20first%20MZI%20layout%20using%20the%20SiEPIC-EBeam%20PDK%20workflow%20in%20Python.%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Use%20modelling%20targets%20(%CE%94L%20%E2%86%94%20FSR)%20to%20guide%20geometry%20choices%2C%20then%20save%20your%20work%20in%20the%20openEBL%20repo.%22%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20badges%3D%5B%22Week%202%22%2C%20%22Lab%20companion%22%2C%20%22PDK%22%2C%20%22openEBL%20workflow%22%5D%2C%0A%20%20%20%20%20%20%20%20toc%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20(%22Overview%22%2C%20%22overview%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%22Build%20MZI%20%2B%20Targets%22%2C%20%22targets%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%22Layout%20skeleton%22%2C%20%22skeleton%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%22Submission%22%2C%20%22submission%22)%2C%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20build%3D%222025-12-16%22%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(doc_callout_list%2C%20mo%2C%20show_overview)%3A%0A%20%20%20%20mo.stop(not%20show_overview)%0A%20%20%20%20overview_md%20%3D%20mo.md(r%22%22%22%0A%20%20%20%20%3Ca%20id%3D%22overview%22%3E%3C%2Fa%3E%0A%20%20%20%20%23%23%20Overview%0A%0A%20%20%20%20This%20is%20the%20**PDK%20%2B%20compact-model%20%2B%20layout**%20companion%20for%20Week%202.%20The%20modelling%20companion%20is%3A%0A%20%20%20%20%60marimo_course%2Flessons%2Fw02_mzi_modelling.py%60%2C%20where%20you%20derived%20and%20explored%20the%20ideal%20MZI%20transfer%20function.%0A%0A%20%20%20%20In%20this%20notebook%2C%20you'll%20connect%20three%20ideas%20that%20show%20up%20in%20every%20photonics%20workflow%3A%0A%0A%20%20%20%20-%20**Compact%20models%3A**%20fast%2C%20circuit-level%20models%20of%20components%20(couplers%2C%20waveguides%2C%20phase%20shifters)%20that%20let%20you%0A%20%20%20%20%20%20simulate%20a%20whole%20photonic%20circuit%20without%20solving%20Maxwell's%20equations%20everywhere.%0A%20%20%20%20-%20**PDK%20(process%20design%20kit)%3A**%20a%20foundry%2Ftechnology%20%22package%22%20that%20defines%20the%20**design%20rules**%2C%20**layers**%2C%20and%0A%20%20%20%20%20%20**parameterized%20building%20blocks**%20(plus%20their%20compact%20models)%20so%20your%20design%20is%20manufacturable%20and%20checkable.%0A%20%20%20%20-%20**Reproducibility%20across%20views%3A**%20build%20the%20*same*%20MZI%20you%20modelled%20last%20lesson%2C%20first%20as%20a%20**circuit**%20from%20compact%0A%20%20%20%20%20%20models%20and%20then%20as%20a%20**layout**%20using%20PDK%20cells.%0A%0A%20%20%20%20In%20lab%2C%20you%20will%3A%0A%0A%20%20%20%201.%20Build%20an%20MZI%20from%20**compact%20models**%20(component%20%E2%86%92%20circuit)%20and%20sanity-check%20it%20against%20the%20Week%202%20model.%0A%20%20%20%202.%20Decide%20on%20a%20**target**%20(FSR%20%E2%86%92%20%CE%94L)%20near%20**1550%20nm**.%0A%20%20%20%203.%20Assemble%20the%20same%20MZI%20from%20**PDK%20building%20blocks**%20(splitter%2C%20waveguides%2C%20combiner%2C%20I%2FO).%0A%20%20%20%204.%20Add%20the%20**conventions**%20required%20for%20downstream%20checks%20(ports%2Fpins%2C%20DevRec%2C%20labels%2Ffloorplan%20as%20required).%0A%20%20%20%205.%20Save%20your%20design%20in%20the%20**openEBL**%20submission%20repo%20and%20keep%20CI%20green.%0A%20%20%20%20%22%22%22)%0A%0A%20%20%20%20goals%20%3D%20doc_callout_list(%0A%20%20%20%20%20%20%20%20%22info%22%2C%0A%20%20%20%20%20%20%20%20tag%3D%22Learning%20goals%22%2C%0A%20%20%20%20%20%20%20%20title%3D%22What%20you%20should%20be%20able%20to%20do%20after%20this%20notebook%22%2C%0A%20%20%20%20%20%20%20%20items%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Explain%20what%20a%20compact%20model%20is%20and%20why%20we%20use%20them%20for%20circuit-level%20photonics%20design.%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Describe%20what%20a%20PDK%20provides%20(layers%2C%20rules%2C%20cells%2C%20models)%20and%20why%20it%20matters%20for%20manufacturable%20layouts.%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Create%20an%20MZI%20from%20compact-model%20building%20blocks%20and%20connect%20%CE%94L%20%E2%86%94%20FSR%20back%20to%20the%20modelling%20notebook.%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Implement%20the%20same%20MZI%20using%20PDK-accurate%20cells%20so%20it%20passes%20downstream%20checks.%22%2C%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20)%0A%0A%20%20%20%20grading_note%20%3D%20doc_callout_list(%0A%20%20%20%20%20%20%20%20%22warning%22%2C%0A%20%20%20%20%20%20%20%20tag%3D%22Where%20is%20the%20graded%20work%3F%22%2C%0A%20%20%20%20%20%20%20%20title%3D%22Lab%20companion%20vs%20homework%22%2C%0A%20%20%20%20%20%20%20%20items%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22This%20notebook%20is%20a%20lab%20companion%20(workflow%20%2B%20checklists%20%2B%20reference).%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Graded%20work%20should%20live%20in%20a%20homework%20notebook%20under%20%60marimo_course%2Fassignments%2F%60.%22%2C%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20)%0A%20%20%20%20mo.vstack(%5Boverview_md%2C%20goals%2C%20grading_note%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_overview)%3A%0A%20%20%20%20mo.stop(not%20show_overview)%0A%20%20%20%20placed_blocks%20%3D%20mo.ui.checkbox(label%3D%22Placed%20I%2FO%20%2B%20splitter%2Fcombiner%20cells%22%2C%20value%3DFalse)%0A%20%20%20%20routed%20%3D%20mo.ui.checkbox(label%3D%22Routed%20an%20MZI%20skeleton%20with%20%CE%94L%22%2C%20value%3DFalse)%0A%20%20%20%20annotated%20%3D%20mo.ui.checkbox(label%3D%22Added%20pins%2FDevRec%2Flabels%20as%20required%22%2C%20value%3DFalse)%0A%20%20%20%20saved%20%3D%20mo.ui.checkbox(label%3D%22Saved%20in%20openEBL%20repo%20%2B%20CI%20checked%22%2C%20value%3DFalse)%0A%20%20%20%20mo.vstack(%5Bplaced_blocks%2C%20routed%2C%20annotated%2C%20saved%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20set_view%2C%20show_overview)%3A%0A%20%20%20%20mo.stop(not%20show_overview)%0A%20%20%20%20go_targets%20%3D%20mo.ui.button(%0A%20%20%20%20%20%20%20%20value%3D0%2C%0A%20%20%20%20%20%20%20%20kind%3D%22success%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Go%20to%20Build%20MZI%20%2B%20Targets%22%2C%0A%20%20%20%20%20%20%20%20on_click%3Dlambda%20v%3A%20(set_view(%22Build%20MZI%20%2B%20Targets%22)%2C%20(v%20or%200)%20%2B%201)%5B-1%5D%2C%0A%20%20%20%20)%0A%20%20%20%20go_skeleton%20%3D%20mo.ui.button(%0A%20%20%20%20%20%20%20%20value%3D0%2C%0A%20%20%20%20%20%20%20%20kind%3D%22neutral%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Go%20to%20Layout%20skeleton%22%2C%0A%20%20%20%20%20%20%20%20on_click%3Dlambda%20v%3A%20(set_view(%22Layout%20skeleton%22)%2C%20(v%20or%200)%20%2B%201)%5B-1%5D%2C%0A%20%20%20%20)%0A%20%20%20%20go_submission%20%3D%20mo.ui.button(%0A%20%20%20%20%20%20%20%20value%3D0%2C%0A%20%20%20%20%20%20%20%20kind%3D%22neutral%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Go%20to%20Submission%22%2C%0A%20%20%20%20%20%20%20%20on_click%3Dlambda%20v%3A%20(set_view(%22Submission%22)%2C%20(v%20or%200)%20%2B%201)%5B-1%5D%2C%0A%20%20%20%20)%0A%20%20%20%20mo.hstack(%5Bgo_targets%2C%20go_skeleton%2C%20go_submission%5D%2C%20justify%3D%22start%22%2C%20gap%3D1)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_targets)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%3Ca%20id%3D%22targets%22%3E%3C%2Fa%3E%0A%20%20%20%20%23%23%20Build%20the%20MZI%20%2B%20targets%0A%0A%20%20%20%20Build%20the%20MZI%20from%20PDK%20components%2C%20render%20the%20layout%2C%20and%20then%20pick%20a%20%CE%94L%20that%0A%20%20%20%20matches%20your%20target%20FSR%20near%201550%20nm.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_targets)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%20%20%20%20import%20textwrap%0A%0A%20%20%20%20layout_code%20%3D%20textwrap.dedent(%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%60%60%60python%0A%20%20%20%20%20%20%20%20%23%20Build%20MZI%2C%20add%20pins%2FDevRec%2Flabels%2Ffloorplan%2C%20and%20export%20a%20GDS.%0A%20%20%20%20%20%20%20%20from%20pathlib%20import%20Path%0A%20%20%20%20%20%20%20%20import%20gdsfactory%20as%20gf%0A%20%20%20%20%20%20%20%20from%20gdsfactory.add_ports%20import%20add_ports_from_markers_center%0A%20%20%20%20%20%20%20%20from%20gdsfactory.read%20import%20import_gds%0A%20%20%20%20%20%20%20%20from%20gdsfactory.port%20import%20auto_rename_ports_orientation%0A%0A%20%20%20%20%20%20%20%20if%20hasattr(gf%2C%20%22gpdk%22)%20and%20hasattr(gf.gpdk%2C%20%22PDK%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gf.gpdk.PDK.activate()%0A%0A%20%20%20%20%20%20%20%20%23%201)%20Define%20the%20waveguide%20cross-section%20used%20for%20routing%20the%20MZI%20arms.%0A%20%20%20%20%20%20%20%20xs%20%3D%20gf.cross_section.strip(layer%3D(1%2C%200)%2C%20width%3D0.5)%0A%20%20%20%20%20%20%20%20pdk_gds%20%3D%20Path(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22SiEPIC_EBeam_PDK_public%2Fklayout%2FEBeam%2Fgds%2FEBeam%2Febeam_bdc_te1550.gds%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%23%202)%20Load%20the%20splitter%20PDK%20cell%20from%20the%20SiEPIC%20GDS%20and%20add%20ports%20from%20PinRec.%0A%20%20%20%20%20%20%20%20splitter%20%3D%20import_gds(pdk_gds%2C%20cellname%3D%22ebeam_bdc_te1550%22)%0A%20%20%20%20%20%20%20%20add_ports_from_markers_center(splitter%2C%20pin_layer%3D(1%2C%2010)%2C%20port_layer%3D(1%2C%200))%0A%20%20%20%20%20%20%20%20auto_rename_ports_orientation(splitter)%0A%0A%20%20%20%20%20%20%20%20%23%203)%20Build%20the%20MZI%20by%20connecting%20two%20splitters%20with%20routed%20waveguide%20arms.%0A%20%20%20%20%20%20%20%20mzi%20%3D%20gf.components.mzi(%0A%20%20%20%20%20%20%20%20%20%20%20%20splitter%3Dsplitter%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20combiner%3Dsplitter%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cross_section%3Dxs%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20port_e1_splitter%3D%22oE1%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20port_e0_splitter%3D%22oE0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20port_e1_combiner%3D%22oE1%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20port_e0_combiner%3D%22oE0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20delta_length%3D50.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length_x%3D60.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length_y%3D10.0%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20gc_gds%20%3D%20Path(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22SiEPIC_EBeam_PDK_public%2Fklayout%2FEBeam%2Fgds%2FEBeam%2Febeam_gc_te1550.gds%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%23%204)%20Load%20the%20grating%20coupler%20cell%20and%20add%20ports%20so%20we%20can%20connect%20to%20I%2FO.%0A%20%20%20%20%20%20%20%20gc%20%3D%20import_gds(gc_gds%2C%20cellname%3D%22ebeam_gc_te1550%22)%0A%20%20%20%20%20%20%20%20add_ports_from_markers_center(gc%2C%20pin_layer%3D(1%2C%2010)%2C%20port_layer%3D(1%2C%200))%0A%20%20%20%20%20%20%20%20auto_rename_ports_orientation(gc)%0A%0A%20%20%20%20%20%20%20%20def%20pick_port(component%2C%20orientation%2C%20*%2C%20fallback_first%3DFalse)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20ports%20%3D%20component.ports%0A%20%20%20%20%20%20%20%20%20%20%20%20port_list%20%3D%20list(ports.values())%20if%20hasattr(ports%2C%20%22values%22)%20else%20list(ports)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20port%20in%20port_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20port.orientation%20is%20not%20None%20and%20int(round(port.orientation))%20%3D%3D%20orientation%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20port%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20fallback_first%20and%20port_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20port_list%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(f%22No%20port%20with%20orientation%20%7Borientation%7D%20on%20%7Bcomponent.name%7D%22)%0A%0A%20%20%20%20%20%20%20%20%23%205)%20Assemble%20the%20final%20layout%20by%20connecting%20two%20GCs%20to%20the%20MZI%20I%2FO%20ports.%0A%20%20%20%20%20%20%20%20c%20%3D%20gf.Component()%0A%20%20%20%20%20%20%20%20mzi_ref%20%3D%20c%20%3C%3C%20mzi%0A%20%20%20%20%20%20%20%20mzi_in%20%3D%20pick_port(mzi_ref%2C%20180)%0A%20%20%20%20%20%20%20%20mzi_out%20%3D%20pick_port(mzi_ref%2C%200)%0A%20%20%20%20%20%20%20%20gc_port%20%3D%20pick_port(gc%2C%20180%2C%20fallback_first%3DTrue)%0A%20%20%20%20%20%20%20%20gc_in%20%3D%20c%20%3C%3C%20gc%0A%20%20%20%20%20%20%20%20gc_in.connect(gc_port.name%2C%20mzi_in)%0A%20%20%20%20%20%20%20%20gc_out%20%3D%20c%20%3C%3C%20gc%0A%20%20%20%20%20%20%20%20gc_out.connect(gc_port.name%2C%20mzi_out)%0A%0A%20%20%20%20%20%20%20%20%23%206)%20Add%20PinRec%20markers%20on%20each%20external%20port%20(required%20by%20openEBL).%0A%20%20%20%20%20%20%20%20pin_layer%20%3D%20(1%2C%2010)%0A%20%20%20%20%20%20%20%20pin_w%20%3D%202.0%0A%20%20%20%20%20%20%20%20pin_h%20%3D%201.0%0A%20%20%20%20%20%20%20%20for%20port%20in%20c.ports.values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cx%2C%20cy%20%3D%20port.center%0A%20%20%20%20%20%20%20%20%20%20%20%20c.add_polygon(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20-%20pin_w%20%2F%202%2C%20cy%20-%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20%2B%20pin_w%20%2F%202%2C%20cy%20-%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20%2B%20pin_w%20%2F%202%2C%20cy%20%2B%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20-%20pin_w%20%2F%202%2C%20cy%20%2B%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3Dpin_layer%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%207)%20Add%20DevRec%20and%20Floorplan%20boxes%20around%20the%20full%20layout%20bbox.%0A%20%20%20%20%20%20%20%20xmin%2C%20ymin%20%3D%20c.bbox%5B0%5D%0A%20%20%20%20%20%20%20%20xmax%2C%20ymax%20%3D%20c.bbox%5B1%5D%0A%20%20%20%20%20%20%20%20pad%20%3D%205.0%0A%20%20%20%20%20%20%20%20c.add_polygon(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20layer%3D(68%2C%200)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20c.add_polygon(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20layer%3D(99%2C%200)%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%208)%20Add%20Text%20labels%20for%20top%20cell%20and%20measurement%20tags.%0A%20%20%20%20%20%20%20%20c.add_label(text%3D%22TOP%22%2C%20position%3D(xmin%2C%20ymax%20%2B%2010.0)%2C%20layer%3D(10%2C%200))%0A%20%20%20%20%20%20%20%20c.add_label(text%3D%22MZI%22%2C%20position%3D(xmin%2C%20ymin%20-%2010.0)%2C%20layer%3D(10%2C%200))%0A%0A%20%20%20%20%20%20%20%20%23%209)%20Export%20a%20submission-ready%20GDS%20to%20the%20openEBL%20submissions%20folder.%0A%20%20%20%20%20%20%20%20out%20%3D%20Path(%22openEBL-2026-02%2Fsubmissions%2FEBeam_username.gds%22)%0A%20%20%20%20%20%20%20%20out.parent.mkdir(parents%3DTrue%2C%20exist_ok%3DTrue)%0A%20%20%20%20%20%20%20%20c.write_gds(out)%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20).strip()%0A%20%20%20%20mo.md(layout_code)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_targets)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%0A%20%20%20%20from%20_notebook_template%20import%20optional_import%20as%20optional_import_preview%0A%0A%20%20%20%20gf_preview%20%3D%20None%0A%20%20%20%20gf_preview%2C%20gf_preview_error%20%3D%20optional_import_preview(%22gdsfactory%22)%0A%20%20%20%20preview_output%20%3D%20None%0A%20%20%20%20if%20gf_preview%20is%20None%3A%0A%20%20%20%20%20%20%20%20preview_notice%20%3D%20%5Bmo.md(%22Layout%20preview%3A%20%60gdsfactory%60%20is%20not%20available%20in%20this%20environment.%22)%5D%0A%20%20%20%20%20%20%20%20if%20gf_preview_error%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20preview_notice.append(mo.md(f%22Details%3A%20%60%7Bgf_preview_error%7D%60%22))%0A%20%20%20%20%20%20%20%20preview_output%20%3D%20mo.vstack(preview_notice)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20import%20pathlib%20as%20pathlib_preview%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20gdsfactory.add_ports%20import%20add_ports_from_markers_center%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20gdsfactory.read%20import%20import_gds%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20gdsfactory.port%20import%20auto_rename_ports_orientation%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20hasattr(gf_preview%2C%20%22gpdk%22)%20and%20hasattr(gf_preview.gpdk%2C%20%22PDK%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gf_preview.gpdk.PDK.activate()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Build%20the%20MZI%20layout%20from%20PDK%20cells%20and%20prepare%20a%20preview%20image.%0A%20%20%20%20%20%20%20%20%20%20%20%20xs%20%3D%20gf_preview.cross_section.strip(layer%3D(1%2C%200)%2C%20width%3D0.5)%0A%20%20%20%20%20%20%20%20%20%20%20%20pdk_gds%20%3D%20pathlib_preview.Path(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SiEPIC_EBeam_PDK_public%2Fklayout%2FEBeam%2Fgds%2FEBeam%2Febeam_bdc_te1550.gds%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20pdk_gds.exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20FileNotFoundError(f%22SiEPIC%20PDK%20GDS%20not%20found%20at%20%7Bpdk_gds%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20splitter%20%3D%20import_gds(pdk_gds%2C%20cellname%3D%22ebeam_bdc_te1550%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20add_ports_from_markers_center(splitter%2C%20pin_layer%3D(1%2C%2010)%2C%20port_layer%3D(1%2C%200))%0A%20%20%20%20%20%20%20%20%20%20%20%20auto_rename_ports_orientation(splitter)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Route%20the%20MZI%20using%20the%20SiEPIC%20splitter%20for%20both%20couplers.%0A%20%20%20%20%20%20%20%20%20%20%20%20mzi%20%3D%20gf_preview.components.mzi(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20splitter%3Dsplitter%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20combiner%3Dsplitter%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cross_section%3Dxs%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e1_splitter%3D%22oE1%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e0_splitter%3D%22oE0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e1_combiner%3D%22oE1%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e0_combiner%3D%22oE0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20delta_length%3D50.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20length_x%3D60.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20length_y%3D10.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gc_gds%20%3D%20pathlib_preview.Path(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SiEPIC_EBeam_PDK_public%2Fklayout%2FEBeam%2Fgds%2FEBeam%2Febeam_gc_te1550.gds%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20gc_gds.exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20FileNotFoundError(f%22SiEPIC%20PDK%20GDS%20not%20found%20at%20%7Bgc_gds%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20gc%20%3D%20import_gds(gc_gds%2C%20cellname%3D%22ebeam_gc_te1550%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20add_ports_from_markers_center(gc%2C%20pin_layer%3D(1%2C%2010)%2C%20port_layer%3D(1%2C%200))%0A%20%20%20%20%20%20%20%20%20%20%20%20auto_rename_ports_orientation(gc)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Attach%20grating%20couplers%20to%20the%20MZI%20input%20and%20output.%0A%20%20%20%20%20%20%20%20%20%20%20%20def%20pick_port(component%2C%20orientation%2C%20*%2C%20fallback_first%3DFalse)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ports%20%3D%20component.ports%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_list%20%3D%20list(ports.values())%20if%20hasattr(ports%2C%20%22values%22)%20else%20list(ports)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20port%20in%20port_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20port.orientation%20is%20not%20None%20and%20int(round(port.orientation))%20%3D%3D%20orientation%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20port%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20fallback_first%20and%20port_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20port_list%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(f%22No%20port%20with%20orientation%20%7Borientation%7D%20on%20%7Bcomponent.name%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20gf_preview.Component()%0A%20%20%20%20%20%20%20%20%20%20%20%20mzi_ref%20%3D%20c%20%3C%3C%20mzi%0A%20%20%20%20%20%20%20%20%20%20%20%20mzi_in%20%3D%20pick_port(mzi_ref%2C%20180)%0A%20%20%20%20%20%20%20%20%20%20%20%20mzi_out%20%3D%20pick_port(mzi_ref%2C%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20gc_port%20%3D%20pick_port(gc%2C%20180%2C%20fallback_first%3DTrue)%0A%20%20%20%20%20%20%20%20%20%20%20%20gc_in%20%3D%20c%20%3C%3C%20gc%0A%20%20%20%20%20%20%20%20%20%20%20%20gc_in.connect(gc_port.name%2C%20mzi_in)%0A%20%20%20%20%20%20%20%20%20%20%20%20gc_out%20%3D%20c%20%3C%3C%20gc%0A%20%20%20%20%20%20%20%20%20%20%20%20gc_out.connect(gc_port.name%2C%20mzi_out)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Render%20the%20layout%20as%20a%20PNG%20for%20display%20in%20the%20notebook.%0A%20%20%20%20%20%20%20%20%20%20%20%20fig%20%3D%20c.plot()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20fig%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig%20%3D%20plt.gcf()%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20io%20import%20BytesIO%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20buf%20%3D%20BytesIO()%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.savefig(buf%2C%20format%3D%22png%22%2C%20bbox_inches%3D%22tight%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20buf.seek(0)%0A%20%20%20%20%20%20%20%20%20%20%20%20preview_output%20%3D%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20Final%20rendering%20(complete%20MZI%20cell)%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(buf)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%20%20%23%20pragma%3A%20no%20cover%0A%20%20%20%20%20%20%20%20%20%20%20%20preview_output%20%3D%20mo.md(f%22(Could%20not%20build%20preview%3A%20%60%7Btype(e).__name__%7D%3A%20%7Be%7D%60)%22)%0A%20%20%20%20preview_output%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(doc_callout_html%2C%20mo%2C%20show_targets)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Targets%3A%20pick%20%CE%94L%20from%20an%20FSR%20target%20(1550%20nm%20default)%0A%0A%20%20%20%20Use%20the%20Week%202%20modelling%20notebook%20to%20build%20intuition%20and%20sanity-check%20values%3A%0A%20%20%20%20%60marimo_course%2Flessons%2Fw02_mzi_modelling.py%60.%0A%0A%20%20%20%20Rule-of-thumb%20near%20%CE%BB0%3A%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmathrm%7BFSR%7D%20%5Capprox%20%5Cfrac%7B%5Clambda_0%5E2%7D%7Bn_g%5C%2C%5CDelta%20L%7D.%0A%20%20%20%20%24%24%0A%20%20%20%20%22%22%22)%0A%0A%20%20%20%20doc_callout_html(%0A%20%20%20%20%20%20%20%20%22info%22%2C%0A%20%20%20%20%20%20%20%20tag%3D%22Tip%22%2C%0A%20%20%20%20%20%20%20%20title%3D%22What%20matters%20for%20FSR%22%2C%0A%20%20%20%20%20%20%20%20html%3D(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22-%20%CE%94L%20sets%20fringe%20spacing%20(FSR)%20approximately%20as%20%601%2F%CE%94L%60.%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%22-%20Base%20length%20doesn%E2%80%99t%20change%20FSR%20in%20the%20ideal%20model.%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%22-%20Use%20**1550%20nm**%20by%20default%3B%20treat%20**1310%20nm**%20as%20an%20extension.%22%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_targets)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%20%20%20%20wl0_nm%20%3D%20mo.ui.number(value%3D1550.0%2C%20label%3D%22%CE%BB0%20(nm)%22)%0A%20%20%20%20ng%20%3D%20mo.ui.number(value%3D4.19%2C%20label%3D%22ng%20(group%20index)%22)%0A%20%20%20%20deltaL_um%20%3D%20mo.ui.number(value%3D50.0%2C%20label%3D%22Planned%20%CE%94L%20(%C2%B5m)%22)%0A%20%20%20%20mo.hstack(%5Bwl0_nm%2C%20ng%2C%20deltaL_um%5D)%0A%20%20%20%20return%20deltaL_um%2C%20ng%2C%20wl0_nm%0A%0A%0A%40app.cell%0Adef%20_(deltaL_um%2C%20mo%2C%20ng%2C%20show_targets%2C%20wl0_nm)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%20%20%20%20wl0_um%20%3D%20float(wl0_nm.value)%20%2F%201e3%0A%20%20%20%20ng_val%20%3D%20float(ng.value)%0A%20%20%20%20delta_L_um%20%3D%20float(deltaL_um.value)%0A%20%20%20%20fsr_nm%20%3D%20(%0A%20%20%20%20%20%20%20%20None%0A%20%20%20%20%20%20%20%20if%20(delta_L_um%20%3C%3D%200%20or%20ng_val%20%3C%3D%200)%0A%20%20%20%20%20%20%20%20else%20(wl0_um%20*%20wl0_um)%20%2F%20(ng_val%20*%20delta_L_um)%20*%201e3%0A%20%20%20%20)%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%22FSR%20estimate%3A%20(enter%20positive%20%CE%94L%20and%20ng)%22%0A%20%20%20%20%20%20%20%20if%20fsr_nm%20is%20None%0A%20%20%20%20%20%20%20%20else%20f%22FSR%20estimate%3A%20**%7Bfsr_nm%3A.2f%7D%20nm**%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_targets)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Notebook%20version%20of%20the%20openEBL%20pre-submission%20steps%0A%0A%20%20%20%20These%20mirror%20the%20typical%20PDK%20workflow%2C%20but%20are%20implemented%20directly%20in%20Python.%0A%20%20%20%20Use%20the%20toggles%20below%20to%20add%20required%20layers%20before%20exporting%20a%20GDS.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_targets)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%20%20%20%20add_pins%20%3D%20mo.ui.checkbox(label%3D%22Add%20PinRec%20markers%20(1%2F10)%22%2C%20value%3DTrue)%0A%20%20%20%20add_devrec%20%3D%20mo.ui.checkbox(label%3D%22Add%20DevRec%20box%20(68%2F0)%22%2C%20value%3DTrue)%0A%20%20%20%20add_floorplan%20%3D%20mo.ui.checkbox(label%3D%22Add%20Floorplan%20box%20(99%2F0)%22%2C%20value%3DFalse)%0A%20%20%20%20add_labels%20%3D%20mo.ui.checkbox(label%3D%22Add%20Text%20labels%20(10%2F0)%22%2C%20value%3DTrue)%0A%20%20%20%20export_path%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20value%3D%22openEBL-2026-02%2Fsubmissions%2FEBeam_username.gds%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Export%20path%22%2C%0A%20%20%20%20)%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.hstack(%5Badd_pins%2C%20add_devrec%2C%20add_floorplan%2C%20add_labels%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20export_path%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20add_devrec%2C%20add_floorplan%2C%20add_labels%2C%20add_pins%2C%20export_path%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20add_devrec%2C%0A%20%20%20%20add_floorplan%2C%0A%20%20%20%20add_labels%2C%0A%20%20%20%20add_pins%2C%0A%20%20%20%20export_path%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20show_targets%2C%0A)%3A%0A%20%20%20%20mo.stop(not%20show_targets)%0A%0A%20%20%20%20from%20_notebook_template%20import%20optional_import%20as%20optional_import_export%0A%0A%20%20%20%20gf_export%20%3D%20None%0A%20%20%20%20gf_export%2C%20gf_export_error%20%3D%20optional_import_export(%22gdsfactory%22)%0A%20%20%20%20build_export_output%20%3D%20None%0A%20%20%20%20if%20gf_export%20is%20None%3A%0A%20%20%20%20%20%20%20%20export_notice%20%3D%20%5Bmo.md(%22Build%2Fexport%3A%20%60gdsfactory%60%20is%20not%20available%20in%20this%20environment.%22)%5D%0A%20%20%20%20%20%20%20%20if%20gf_export_error%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20export_notice.append(mo.md(f%22Details%3A%20%60%7Bgf_export_error%7D%60%22))%0A%20%20%20%20%20%20%20%20build_export_output%20%3D%20mo.vstack(export_notice)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20import%20pathlib%20as%20pathlib_export%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20gdsfactory.add_ports%20import%20add_ports_from_markers_center%20as%20add_ports_export%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20gdsfactory.read%20import%20import_gds%20as%20import_gds_export%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20gdsfactory.port%20import%20auto_rename_ports_orientation%20as%20rename_ports_export%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20hasattr(gf_export%2C%20%22gpdk%22)%20and%20hasattr(gf_export.gpdk%2C%20%22PDK%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gf_export.gpdk.PDK.activate()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Build%20the%20base%20MZI%20layout%20(same%20as%20preview)%20and%20then%20add%20submission%20layers.%0A%20%20%20%20%20%20%20%20%20%20%20%20xs_export%20%3D%20gf_export.cross_section.strip(layer%3D(1%2C%200)%2C%20width%3D0.5)%0A%20%20%20%20%20%20%20%20%20%20%20%20pdk_gds_export%20%3D%20pathlib_export.Path(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SiEPIC_EBeam_PDK_public%2Fklayout%2FEBeam%2Fgds%2FEBeam%2Febeam_bdc_te1550.gds%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20pdk_gds_export.exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20build_export_output%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22(Build%2Fexport%20failed%3A%20SiEPIC%20splitter%20GDS%20not%20found%20at%20%60%7Bpdk_gds_export%7D%60)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Load%20the%20splitter%20cell%20from%20the%20PDK%20and%20make%20sure%20ports%20are%20available.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20splitter_export%20%3D%20import_gds_export(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pdk_gds_export%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cellname%3D%22ebeam_bdc_te1550%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rename_duplicated_cells%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20add_ports_export(splitter_export%2C%20pin_layer%3D(1%2C%2010)%2C%20port_layer%3D(1%2C%200))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rename_ports_export(splitter_export)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20splitter_export.name%20%3D%20%22ebeam_bdc_te1550_splitter%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mzi_export%20%3D%20gf_export.components.mzi(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20splitter%3Dsplitter_export%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20combiner%3Dsplitter_export%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cross_section%3Dxs_export%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e1_splitter%3D%22oE1%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e0_splitter%3D%22oE0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e1_combiner%3D%22oE1%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_e0_combiner%3D%22oE0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20delta_length%3D50.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20length_x%3D60.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20length_y%3D10.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_gds_export%20%3D%20pathlib_export.Path(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SiEPIC_EBeam_PDK_public%2Fklayout%2FEBeam%2Fgds%2FEBeam%2Febeam_gc_te1550.gds%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20gc_gds_export.exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20build_export_output%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22(Build%2Fexport%20failed%3A%20SiEPIC%20GC%20GDS%20not%20found%20at%20%60%7Bgc_gds_export%7D%60)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Load%20the%20grating%20coupler%20cell%20for%20I%2FO.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_export%20%3D%20import_gds_export(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_gds_export%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cellname%3D%22ebeam_gc_te1550%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rename_duplicated_cells%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20add_ports_export(gc_export%2C%20pin_layer%3D(1%2C%2010)%2C%20port_layer%3D(1%2C%200))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rename_ports_export(gc_export)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_export.name%20%3D%20%22ebeam_gc_te1550_gc%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20def%20pick_port_export(component%2C%20orientation%2C%20*%2C%20fallback_first%3DFalse)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ports%20%3D%20component.ports%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_list%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20list(ports.values())%20if%20hasattr(ports%2C%20%22values%22)%20else%20list(ports)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20port%20in%20port_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20port.orientation%20is%20not%20None%20and%20int(round(port.orientation))%20%3D%3D%20orientation%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20port%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20fallback_first%20and%20port_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20port_list%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22No%20port%20with%20orientation%20%7Borientation%7D%20on%20%7Bcomponent.name%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Assemble%20the%20final%20layout%20by%20connecting%20GCs%20to%20the%20MZI%20ports.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c_export%20%3D%20gf_export.Component()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mzi_ref_export%20%3D%20c_export%20%3C%3C%20mzi_export%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mzi_in_export%20%3D%20pick_port_export(mzi_ref_export%2C%20180)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mzi_out_export%20%3D%20pick_port_export(mzi_ref_export%2C%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_port_export%20%3D%20pick_port_export(gc_export%2C%20180%2C%20fallback_first%3DTrue)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_in_export%20%3D%20c_export%20%3C%3C%20gc_export%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_in_export.connect(gc_port_export.name%2C%20mzi_in_export)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_out_export%20%3D%20c_export%20%3C%3C%20gc_export%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gc_out_export.connect(gc_port_export.name%2C%20mzi_out_export)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Add%20PinRec%20markers%20for%20all%20external%20ports%20(required%20for%20openEBL).%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20add_pins.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pin_layer%20%3D%20(1%2C%2010)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pin_w%20%3D%202.0%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pin_h%20%3D%201.0%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ports%20%3D%20c_export.ports%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20port_list%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20list(ports.values())%20if%20hasattr(ports%2C%20%22values%22)%20else%20list(ports)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20port%20in%20port_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cx%2C%20cy%20%3D%20port.center%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c_export.add_polygon(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20-%20pin_w%20%2F%202%2C%20cy%20-%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20%2B%20pin_w%20%2F%202%2C%20cy%20-%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20%2B%20pin_w%20%2F%202%2C%20cy%20%2B%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(cx%20-%20pin_w%20%2F%202%2C%20cy%20%2B%20pin_h%20%2F%202)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3Dpin_layer%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20def%20get_bbox(component)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bbox%20%3D%20component.bbox()%20if%20callable(getattr(component%2C%20%22bbox%22%2C%20None))%20else%20component.bbox%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20hasattr(bbox%2C%20%22left%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20bbox.left%2C%20bbox.bottom%2C%20bbox.right%2C%20bbox.top%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20hasattr(bbox%2C%20%22__getitem__%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%2C%20ymin)%2C%20(xmax%2C%20ymax)%20%3D%20bbox%5B0%5D%2C%20bbox%5B1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20xmin%2C%20ymin%2C%20xmax%2C%20ymax%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20TypeError(%22Unsupported%20bbox%20type%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Add%20DevRec%20and%20optional%20Floorplan%20around%20the%20layout%20bbox.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20add_devrec.value%20or%20add_floorplan.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xmin%2C%20ymin%2C%20xmax%2C%20ymax%20%3D%20get_bbox(c_export)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pad%20%3D%205.0%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20add_devrec.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c_export.add_polygon(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3D(68%2C%200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20add_floorplan.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c_export.add_polygon(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymin%20-%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmax%20%2B%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(xmin%20-%20pad%2C%20ymax%20%2B%20pad)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3D(99%2C%200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Add%20Text%20labels%20for%20top-cell%20naming%20and%20identification.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20add_labels.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xmin%2C%20ymin%2C%20xmax%2C%20ymax%20%3D%20get_bbox(c_export)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c_export.add_label(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3D%22TOP%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20position%3D(xmin%2C%20ymax%20%2B%2010.0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3D(10%2C%200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c_export.add_label(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3D%22MZI%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20position%3D(xmin%2C%20ymin%20-%2010.0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3D(10%2C%200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Export%20the%20final%20GDS%20to%20the%20openEBL%20submissions%20folder.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20out_export%20%3D%20pathlib_export.Path(str(export_path.value)).expanduser()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20out_export.parent.mkdir(parents%3DTrue%2C%20exist_ok%3DTrue)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20written_export%20%3D%20c_export.write_gds(out_export)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20build_export_output%20%3D%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22Wrote%3A%20%60%7Bwritten_export%7D%60%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Reminder%3A%20verify%20the%20top-cell%20name%20and%20port%20labels%20in%20your%20layout%20viewer.%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%20%20%23%20pragma%3A%20no%20cover%0A%20%20%20%20%20%20%20%20%20%20%20%20build_export_output%20%3D%20mo.md(f%22(Build%2Fexport%20failed%3A%20%60%7Btype(e).__name__%7D%3A%20%7Be%7D%60)%22)%0A%20%20%20%20build_export_output%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20show_skeleton)%3A%0A%20%20%20%20mo.stop(not%20show_skeleton)%0A%20%20%20%20enable_gdsfactory%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20label%3D%22Enable%20gdsfactory%20helper%20(may%20take%20a%20while%20to%20import)%22%2C%0A%20%20%20%20%20%20%20%20value%3DFalse%2C%0A%20%20%20%20)%0A%20%20%20%20enable_gdsfactory%0A%20%20%20%20return%20(enable_gdsfactory%2C)%0A%0A%0A%40app.cell%0Adef%20_(enable_gdsfactory%2C%20mo%2C%20show_skeleton)%3A%0A%20%20%20%20mo.stop(not%20show_skeleton)%0A%20%20%20%20from%20_notebook_template%20import%20optional_import%20as%20optional_import_skeleton%0A%0A%20%20%20%20gf_mod%20%3D%20None%0A%20%20%20%20available%20%3D%20False%0A%20%20%20%20if%20not%20enable_gdsfactory.value%3A%0A%20%20%20%20%20%20%20%20msg%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Optional%20gdsfactory%20helper%3A%20**disabled**%20(enable%20the%20checkbox%20to%20import)%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20gf_mod%2C%20gf_error%20%3D%20optional_import_skeleton(%22gdsfactory%22)%0A%20%20%20%20%20%20%20%20available%20%3D%20gf_mod%20is%20not%20None%0A%20%20%20%20%20%20%20%20msg%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Optional%20gdsfactory%20helper%3A%20**available**%22%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20available%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20f%22Optional%20gdsfactory%20helper%3A%20**not%20available**%20(%60%7Bgf_error%7D%60)%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20msg%0A%20%20%20%20return%20available%2C%20gf_mod%0A%0A%0A%40app.cell%0Adef%20_(available%2C%20mo%2C%20show_skeleton)%3A%0A%20%20%20%20mo.stop(not%20show_skeleton)%0A%20%20%20%20mo.stop(not%20available)%0A%0A%20%20%20%20%23%20Parameters%20for%20a%20quick%2C%20generic%20MZI%20skeleton%20export.%0A%20%20%20%20gds_out%20%3D%20mo.ui.text(value%3D%22marimo_course%2Fbuild%2Fweek2_mzi_skeleton.gds%22%2C%20label%3D%22GDS%20output%20path%22)%0A%20%20%20%20delta_length%20%3D%20mo.ui.number(value%3D50.0%2C%20label%3D%22%CE%94L%20(%C2%B5m)%22)%0A%20%20%20%20length_x%20%3D%20mo.ui.number(value%3D60.0%2C%20label%3D%22length_x%20(%C2%B5m)%22)%0A%20%20%20%20length_y%20%3D%20mo.ui.number(value%3D10.0%2C%20label%3D%22length_y%20(%C2%B5m)%22)%0A%20%20%20%20write%20%3D%20mo.ui.button(value%3D0%2C%20label%3D%22Write%20GDS%22%2C%20kind%3D%22success%22%2C%20on_click%3Dlambda%20v%3A%20(v%20or%200)%20%2B%201)%0A%20%20%20%20mo.vstack(%5Bmo.hstack(%5Bgds_out%2C%20write%5D)%2C%20mo.hstack(%5Bdelta_length%2C%20length_x%2C%20length_y%5D)%5D)%0A%20%20%20%20return%20delta_length%2C%20gds_out%2C%20length_x%2C%20length_y%2C%20write%0A%0A%0A%40app.cell%0Adef%20_(available%2C%20gf_mod%2C%20mo%2C%20show_skeleton)%3A%0A%20%20%20%20mo.stop(not%20show_skeleton)%0A%20%20%20%20mo.stop(not%20available)%0A%0A%20%20%20%20from%20pathlib%20import%20Path%0A%0A%20%20%20%20def%20write_mzi_skeleton(*%2C%20out%3A%20Path%2C%20delta_length_um%3A%20float%2C%20length_x_um%3A%20float%2C%20length_y_um%3A%20float)%20-%3E%20Path%3A%0A%20%20%20%20%20%20%20%20gf%20%3D%20gf_mod%0A%20%20%20%20%20%20%20%20%23%20Create%20a%20generic%20MZI%20to%20visualize%20geometry%20only%20(not%20PDK-accurate).%0A%20%20%20%20%20%20%20%20mzi%20%3D%20gf.components.mzi(%0A%20%20%20%20%20%20%20%20%20%20%20%20delta_length%3Dfloat(delta_length_um)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length_x%3Dfloat(length_x_um)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length_y%3Dfloat(length_y_um)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20out.parent.mkdir(parents%3DTrue%2C%20exist_ok%3DTrue)%0A%20%20%20%20%20%20%20%20written%20%3D%20mzi.write_gds(gdspath%3Dout)%0A%20%20%20%20%20%20%20%20return%20Path(written)%0A%20%20%20%20return%20Path%2C%20write_mzi_skeleton%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20Path%2C%0A%20%20%20%20available%2C%0A%20%20%20%20delta_length%2C%0A%20%20%20%20gds_out%2C%0A%20%20%20%20length_x%2C%0A%20%20%20%20length_y%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20show_skeleton%2C%0A%20%20%20%20write%2C%0A%20%20%20%20write_mzi_skeleton%2C%0A)%3A%0A%20%20%20%20mo.stop(not%20show_skeleton)%0A%20%20%20%20mo.stop(not%20available)%0A%0A%20%20%20%20blocks%20%3D%20%5B%5D%0A%20%20%20%20if%20int(write.value%20or%200)%20%3C%3D%200%3A%0A%20%20%20%20%20%20%20%20blocks.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22Click%20**Write%20GDS**%20to%20export%20a%20skeleton%20you%20can%20inspect%20in%20a%20layout%20viewer.%22)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20out%20%3D%20Path(str(gds_out.value)).expanduser()%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Write%20the%20skeleton%20GDS%20file%20and%20report%20the%20path.%0A%20%20%20%20%20%20%20%20%20%20%20%20written%20%3D%20write_mzi_skeleton(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20out%3Dout%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20delta_length_um%3Dfloat(delta_length.value)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20length_x_um%3Dfloat(length_x.value)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20length_y_um%3Dfloat(length_y.value)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20blocks.append(mo.md(f%22Wrote%3A%20%60%7Bwritten%7D%60%22))%0A%20%20%20%20%20%20%20%20%20%20%20%20blocks.append(mo.md(f%22Open%20in%20your%20layout%20viewer%3A%20%60%7Bwritten%7D%60%22))%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%20%20%23%20pragma%3A%20no%20cover%0A%20%20%20%20%20%20%20%20%20%20%20%20blocks.append(mo.md(f%22(GDS%20write%20failed%3A%20%60%7Btype(e).__name__%7D%3A%20%7Be%7D%60)%22))%0A%0A%20%20%20%20mo.vstack(blocks)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(doc_callout_list%2C%20mo%2C%20show_submission)%3A%0A%20%20%20%20mo.stop(not%20show_submission)%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%3Ca%20id%3D%22submission%22%3E%3C%2Fa%3E%0A%20%20%20%20%23%23%20Save%20%2B%20submission%20workflow%20(openEBL)%0A%0A%20%20%20%20The%20details%20depend%20on%20the%20specific%20openEBL%20run%20repository%20used%20this%20semester%2C%20but%20the%20structure%20is%20consistent%3A%0A%20%20%20%20save%20designs%20in%20the%20right%20folder%2C%20run%20checks%2C%20fix%20failures%2C%20and%20submit%20via%20PR.%0A%20%20%20%20%22%22%22)%0A%0A%20%20%20%20doc_callout_list(%0A%20%20%20%20%20%20%20%20%22info%22%2C%0A%20%20%20%20%20%20%20%20tag%3D%22Checklist%22%2C%0A%20%20%20%20%20%20%20%20title%3D%22Before%20you%20push%22%2C%0A%20%20%20%20%20%20%20%20ordered%3DTrue%2C%0A%20%20%20%20%20%20%20%20items%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Confirm%20your%20layout%20file%20is%20inside%20the%20run%20repo%20(e.g.%2C%20%60openEBL-2026-02%2Fsubmissions%2F...%60).%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Verify%20naming%20conventions%20and%20top-level%20cell%20structure%20match%20the%20run%20instructions.%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Run%20local%20verification%20in%20your%20layout%20viewer%20if%20available.%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Push%20to%20your%20fork%20and%20check%20GitHub%20Actions%20results%3B%20download%20artifacts%20when%20something%20fails.%22%2C%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">1376639993a3a7fc961ea56dd2b12d5f</marimo-code-hash>
</body>
</html>
