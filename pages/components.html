
<!DOCTYPE html>

<html data-content_root="" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Components — CamachoLab Photonics Bootcamp</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" rel="stylesheet" type="text/css"/>
<link href="../_static/togglebutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="../_static/doctools.js"></script>
<script src="../_static/clipboard.min.js"></script>
<script src="../_static/copybutton.js"></script>
<script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="../_static/design-tabs.js"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../_static/sphinx-thebe.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'pages/components';</script>
<link href="https://byucamacholab.github.io/Photonics-Bootcamp/pages/components.html" rel="canonical"/>
<link href="../_static/favicon-laser.svg" rel="shortcut icon"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="gds_to_meep.html" rel="next" title="GDS to Meep"/>
<link href="layer_stack.html" rel="prev" title="Defining the layer stack"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<link href="../_static/styles/chattutor.style.css" rel="stylesheet" type="text/css"/></head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<div class="skip-link d-print-none" id="pst-skip-link"><a href="#main-content">Skip to main content</a></div>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>Back to top</button>
<input class="sidebar-toggle" id="pst-primary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
<input class="sidebar-toggle" id="pst-secondary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<div class="pst-async-banner-revealer d-none">
<aside aria-label="Version warning" class="d-none d-print-none" id="bd-header-version-warning"></aside>
</div>
<aside aria-label="Announcement" class="bd-header-announcement">
<div class="bd-header-announcement__content">New marimo course available: <a href="https://byucamacholab.github.io/Photonics-Bootcamp/next/">/next/</a></div>
</aside>
<header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<a class="navbar-brand logo" href="../index.html">
<img alt="CamachoLab Photonics Bootcamp - Home" class="logo__image only-light" src="../_static/logo.png"/>
<script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="CamachoLab Photonics Bootcamp - Home"/>`);</script>
</a></div>
<div class="sidebar-primary-item"><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="open_source.html">Open source software</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="software.html">Software</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="wsl.html">WSL (Windows-only)</a></li>
<li class="toctree-l2"><a class="reference internal" href="vscode.html">Visual Studio Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_and_github.html">Git (and GitHub)</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="klayout.html">KLayout</a></li>
<li class="toctree-l2"><a class="reference internal" href="laboratory_tools.html">Laboratory Tools</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Passive Device Design and Simulation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="photonic_devices.html">What are photonic devices?</a></li>
<li class="toctree-l1"><a class="reference internal" href="layer_stack.html">Defining the layer stack</a></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Components</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="gds_to_meep.html">GDS to Meep</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="waveguides.html">Waveguides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="waveguides_tir.html">Total Internal Reflection</a></li>
<li class="toctree-l2"><a class="reference internal" href="waveguides_polarization.html">Polarization</a></li>
<li class="toctree-l2"><a class="reference internal" href="ray_optic_model.html">Improving the Ray-optic Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="waveguides_modelling.html">Modelling Wavegudies</a></li>
<li class="toctree-l2"><a class="reference internal" href="waveguides_mode_solvers.html">Waveguide modes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="passive_components.html">Passive Components</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="directional_couplers.html">Directional couplers</a></li>
<li class="toctree-l2"><a class="reference internal" href="y_branch.html">Y-Branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="ring_resonators.html">Ring Resonators</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmis.html">Multimode Interferometers (MMIs)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="optical_io.html">Optical I/O</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="grating_couplers.html">Grating couplers</a></li>
<li class="toctree-l2"><a class="reference internal" href="edge_couplers.html">Edge couplers</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="optimization.html">Optimization and inverse design</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="shape_optimization.html">Shape optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="adjoint_optimization.html">Adjoint optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="meep_to_gds.html">Meep to GDS</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="compact_models.html">Compact models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="scattering_parameters.html">Scattering parameters</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="drc.html">Design rule checks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Circuit Design and Simulation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pdks.html">Process design kits</a></li>
<li class="toctree-l1"><a class="reference internal" href="mzi.html">Mach-Zehnder interferometers</a></li>
<li class="toctree-l1"><a class="reference internal" href="mzi_layout.html">Laying out a Mach-Zehnder Interferometer</a></li>
<li class="toctree-l1"><a class="reference internal" href="layout_demo.html">Layout Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Active Device Design and Simulation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="advanced_components.html">Advanced Components</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="phase_shifters.html">Phase Shifters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="phase_shifters_heaters.html">Heaters</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase_shifters_pn.html">PN and PIN Junctions</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Testing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="analyzing_circuits.html">Analyzing circuits</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/BYUCamachoLab/sky130ph">Repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/BYUCamachoLab/sky130ph/docs">PDK Documentation</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content" role="main">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</label></div>
</div>
<div class="header-article-items__end">
<div class="header-article-item">
<div class="article-header-buttons">
<div class="dropdown dropdown-launch-buttons">
<button aria-expanded="false" aria-label="Launch interactive content" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-rocket"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://mybinder.org/v2/gh/BYUCamachoLab/Photonics-Bootcamp/main?urlpath=tree/book/pages/components.ipynb" target="_blank" title="Launch onBinder">
<span class="btn__icon-container">
<img src="../_static/images/logo_binder.svg"/>
</span>
<span class="btn__text-container">Binder</span>
</a>
</li>
<li><a class="btn btn-sm dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://colab.research.google.com/github/BYUCamachoLab/Photonics-Bootcamp/blob/main/book/pages/components.ipynb" target="_blank" title="Launch onColab">
<span class="btn__icon-container">
<img src="../_static/images/logo_colab.png"/>
</span>
<span class="btn__text-container">Colab</span>
</a>
</li>
</ul>
</div>
<div class="dropdown dropdown-source-buttons">
<button aria-expanded="false" aria-label="Source repositories" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fab fa-github"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-source-repository-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://github.com/BYUCamachoLab/Photonics-Bootcamp" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="btn__text-container">Repository</span>
</a>
</li>
<li><a class="btn btn-sm btn-source-edit-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://github.com/BYUCamachoLab/Photonics-Bootcamp/edit/main/book/pages/components.ipynb" target="_blank" title="Suggest edit">
<span class="btn__icon-container">
<i class="fas fa-pencil-alt"></i>
</span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
<li><a class="btn btn-sm btn-source-issues-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://github.com/BYUCamachoLab/Photonics-Bootcamp/issues/new?title=Issue%20on%20page%20%2Fpages/components.html&amp;body=Your%20issue%20content%20here." target="_blank" title="Open an issue">
<span class="btn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
</ul>
</div>
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-download-source-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="../_sources/pages/components.ipynb" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="btn btn-sm btn-download-pdf-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" onclick="window.print()" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
<button class="btn btn-sm btn-fullscreen-button" data-bs-placement="bottom" data-bs-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>
<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__secondary" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</label>
</div></div>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Components</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#elements-of-a-component">Elements of a Component</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polygons">Polygons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ports">Ports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#labels">Labels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components-from-polygons">Components from polygons</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#translation-and-rotation-of-polygons">Translation and rotation of polygons</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boolean-operations">Boolean operations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-cells">Parametric cells</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapes-and-generic-cells">Shapes and generic cells</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-ports">Adding ports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components-using-references">Components using references</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exporting-components-to-gds-files">Exporting components to GDS files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-components-from-gds-files">Importing components from GDS files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-components-using-ports">Connecting components using ports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
</nav>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<section class="tex2jax_ignore mathjax_ignore" id="components">
<h1>Components<a class="headerlink" href="#components" title="Permalink to this heading">#</a></h1>
<p>In <a class="reference internal" href="glossary.html#term-gdsfactory"><span class="xref std std-term">gdsfactory</span></a>, we create components and then connect them together to create larger, more complicated designs. Components can be simple shapes or more complex constructions, for example, containing references to other components. They usually have ports which allow you to connect the component to other components in GDS Factory. When ports are defined, the translation and aligning of ports to each other is taken care of for you automatically.</p>
<section id="elements-of-a-component">
<h2>Elements of a Component<a class="headerlink" href="#elements-of-a-component" title="Permalink to this heading">#</a></h2>
<p>Components can be made up of polygons, references, ports and (optionally) labels.</p>
<p>Most basically, to start building a component, you need to create the <code class="docutils literal notranslate"><span class="pre">Component</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Components have a series of convenience functions to help you visualize them in Jupyter notebooks. For example:</p>
<ul class="simple">
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot</span></code></span></p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot_holoviews</span></code></span></p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot_jupyter</span></code></span></p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot_klayout</span></code></span></p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot_matplotlib</span></code></span></p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot_netlist</span></code></span></p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot_netlist_flat</span></code></span></p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plot_widget</span></code></span></p></li>
</ul>
<p>Some of these are aliases for each other. For example, <code class="docutils literal notranslate"><span class="pre">plot</span></code> will by default use <code class="docutils literal notranslate"><span class="pre">plot_klayout</span></code>, and could be changed using a keyword argument to use <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. In the below examples, for formatting, we’ll be explicit. But <strong>the recommended plot function is <code class="docutils literal notranslate"><span class="pre">plot</span></code></strong>, which will display an interactive klayout widget in Jupyter notebooks.</p>
</div>
<section id="polygons">
<h3>Polygons<a class="headerlink" href="#polygons" title="Permalink to this heading">#</a></h3>
<p>Polygons are the lowest building block of components. They are simply an ordered list of vertices, each adjacent pair of vertices defining a line that does not cross any other lines within the shape (although overlapping of parallel lines is allowed, and vertices can lie upon other lines).</p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<p>References point to an existing geometry instead of creating a new one. That geometry can be a component defined by a polygon, a more complex parameterized component (called a parametric cell), or even a hierarchical component (cell with component nesting). They save memory because the the core geometry is only defined once but is referenced many times. These references can be translated, rotated and placed anywhere independently, but those operations are all applied to the base instance.</p>
<p>For example, if you had a component that used the same taper on all of its inputs and outputs, instead of repeatedly defining the same taper, it would be good to create the taper only once and then reference it and rotate it (if required) as many times as you need for the higher-level component. By using references you can draw on a bank of components to create more complex components without using up as much memory.</p>
<p>This follows the pattern used in GDS files, where a cell is defined once and then referenced many times across a design.</p>
</section>
<section id="ports">
<h3>Ports<a class="headerlink" href="#ports" title="Permalink to this heading">#</a></h3>
<p>Ports are placed at the inputs and outputs of components.</p>
<p>In a hierarchical component (one composed of many other components), you’ll place it at the interconnect of the compound component and not the intermediate ones. You must specify the direction the port is facing (generally either into or out of the component). You can also specify the width of the port, although it is generally just the width of the input or output of the component it is attached to.</p>
</section>
<section id="labels">
<h3>Labels<a class="headerlink" href="#labels" title="Permalink to this heading">#</a></h3>
<p>You can also add labels to your component to convey information not otherwise included. These labels will be seen in the gds file as well as in <code class="docutils literal notranslate"><span class="pre">gdsfactory</span></code>.</p>
<p>A label is added to a component using the function <a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/00_geometry.html?highlight=add_label#labels"><code class="docutils literal notranslate"><span class="pre">add_label</span></code></a>, to which you pass the label text and location where it should be in the component, as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">"LABEL TEXT"</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="components-from-polygons">
<h2>Components from polygons<a class="headerlink" href="#components-from-polygons" title="Permalink to this heading">#</a></h2>
<p>In gdsfactory, polygons can be used to build up a component’s geometry. Polygons are defined by their (ordered) vertices and the GDS layer on which they lie. For components with more complex functions, i.e. not just passive components, several polygons laying on more than one layer may be needed to define the component. You can specify what parts of your component are on which layer when adding the polygon to the component. Components track the number of polygons they contain.</p>
<p>As an example, let us create a taper using polygons. We create polygons by passing a list of tuples (the coordinates) to the <code class="docutils literal notranslate"><span class="pre">points</span></code> keyword argument. When specifying points we need to do this in an ordered, circular fashion as shown below. The initial point should not be repeated as the last point, as it is inferred that the polygon is closed.</p>
<p><em>(This script is complete, it should run “as is”)</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>

<span class="c1"># Create a component containing a polygon for the taper</span>
<span class="c1"># This will be referenced in the final component</span>
<span class="n">taper</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>

<span class="n">t_length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">t_width_in</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">t_width_out</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Add polygon defining the taper waveguide shape</span>
<span class="n">taper</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span>
    <span class="n">points</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">t_width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="n">t_length</span><span class="p">,</span> <span class="n">t_width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="n">t_length</span><span class="p">,</span> <span class="o">-</span><span class="n">t_width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">],</span> 
    <span class="c1"># GDS layers are tuples of ints, but if we use only one number it assumes </span>
    <span class="c1"># we've provided the layer number and that the other number, the datatype, </span>
    <span class="c1"># is 0.</span>
    <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Visualize the taper</span>
<span class="n">taper</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/70b9e901f634e74c654736ccc4c0b84bd0bb88991ddb030c49e11b1533e67bde.png" src="../_images/70b9e901f634e74c654736ccc4c0b84bd0bb88991ddb030c49e11b1533e67bde.png">
</img></div>
</div>
</section>
<section id="translation-and-rotation-of-polygons">
<h2>Translation and rotation of polygons<a class="headerlink" href="#translation-and-rotation-of-polygons" title="Permalink to this heading">#</a></h2>
<p>Polygons can also be translated and rotated.</p>
<p><em>(This script is complete, it should run “as is”)</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>

<span class="c1"># Create a component containing a polygon for the taper</span>
<span class="c1"># This will be referenced in the final component</span>
<span class="n">taper</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>

<span class="n">t_length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">t_width_in</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">t_width_out</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Add polygon defining the taper waveguide shape</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">taper</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span>
    <span class="n">points</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">t_width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="n">t_length</span><span class="p">,</span> <span class="n">t_width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="n">t_length</span><span class="p">,</span> <span class="o">-</span><span class="n">t_width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">],</span> 
    <span class="c1"># GDS layers are tuples of ints, but if we use only one number it assumes </span>
    <span class="c1"># we've provided the layer number and that the other number, the datatype, </span>
    <span class="c1"># is 0.</span>
    <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">poly</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="n">poly</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
          
<span class="c1"># Visualize the taper</span>
<span class="n">taper</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e798c9a0985d32f46d44327197d1751184269ee7b9d9a96989bebba1684d5a61.png" src="../_images/e798c9a0985d32f46d44327197d1751184269ee7b9d9a96989bebba1684d5a61.png">
</img></div>
</div>
</section>
<section id="boolean-operations">
<h2>Boolean operations<a class="headerlink" href="#boolean-operations" title="Permalink to this heading">#</a></h2>
<p>gdsfactory comes with a variety of functions that can help you manipulate the geometry of your component, allowing you to more easily create many different shapes. For example, there are Boolean operators you can use to combine different geometries, meaning that you can subtract shapes from each other, merge them together, or XOR them.</p>
<p>To use these operations, you specify the two groups of pieces of the geometry that will be involved in the operation, the operation itself, and the target layer (where to place the resulting geometry):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span>
    <span class="n">A</span><span class="o">=</span><span class="p">[</span><span class="n">components_a</span><span class="p">],</span> <span class="n">B</span><span class="o">=</span><span class="p">[</span><span class="n">components_b</span><span class="p">],</span> <span class="n">operation</span><span class="o">=</span><span class="s2">"A-B"</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The accepted operations are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">"and"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"not"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"or"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"xor"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"A-B"</span></code> (equivalent to “not”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"B-A"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"A+B"</span></code> (equivalent to “or”)</p></li>
</ul>
<p><em>(This script is complete, it should run “as is”)</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="n">circle</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
<span class="n">circle</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">triangle</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
<span class="n">triangle</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pacman</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">circle</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">triangle</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s2">"A-B"</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Plot the originals and the result</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s2">"boolean_subtraction"</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">pacman</span><span class="p">)</span> <span class="c1"># we'll talk about references later</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d1a48fc3a77c855069b558a2e957eb9109042b7fd19e32439c6cb8a5c423333a.png" src="../_images/d1a48fc3a77c855069b558a2e957eb9109042b7fd19e32439c6cb8a5c423333a.png"/>
</div>
</div>
</section>
<section id="parametric-cells">
<h2>Parametric cells<a class="headerlink" href="#parametric-cells" title="Permalink to this heading">#</a></h2>
<p>To parameterize this process to make tapers of different dimensions, or to repeatedly use the same geometry without redefining the shape and vertices every time, we can write a function that returns a component. This is called a parametric cell.</p>
<p>In addition to calculating the location of the points for us, it caches the input parameters and its corresponding output geometry so that any subsequent call with the same parameters will return the geometry without rebuilding it. In order to enable this functionality, you must use the <code class="docutils literal notranslate"><span class="pre">@gf.cell</span></code> decorator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you’re developing in a notebook, because of caching, if you modify the contents of a cell and call it again without changing the parameters, your new code won’t be run. You need to clear <code class="docutils literal notranslate"><span class="pre">gdsfactory</span></code>’s cache using <code class="docutils literal notranslate"><span class="pre">gf.clear_cache()</span></code>.</p>
</div>
<p>Writing cell functions is a good way to create a library of reusable components for your circuits. Another fantastic benefit of writing cells is, if you type-hint them, gdsfactory will automatically validate arguments types.</p>
<p>Let’s create a parametric cell for tapers named <code class="docutils literal notranslate"><span class="pre">taper()</span></code>. We’ll be able to create new tapers by simply calling</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">taper_component</span> <span class="o">=</span> <span class="n">taper</span><span class="p">()</span>
</pre></div>
</div>
<p><em>(This script is complete, it should run “as is”)</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>

<span class="nd">@gf</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">taper</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">width_in</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">width_out</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
    <span class="c1"># Create a component containing a polygon for the taper</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>

    <span class="c1"># Add polygon defining the taper waveguide shape</span>
    <span class="n">c</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span>
        <span class="n">points</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="o">-</span><span class="n">width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">],</span> 
        <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Return the constructed component</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="c1"># Visualize the taper</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">taper</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/70b9e901f634e74c654736ccc4c0b84bd0bb88991ddb030c49e11b1533e67bde.png" src="../_images/70b9e901f634e74c654736ccc4c0b84bd0bb88991ddb030c49e11b1533e67bde.png"/>
</div>
</div>
<section id="shapes-and-generic-cells">
<h3>Shapes and generic cells<a class="headerlink" href="#shapes-and-generic-cells" title="Permalink to this heading">#</a></h3>
<p>Just like we’ve created a new cell called <code class="docutils literal notranslate"><span class="pre">taper()</span></code>, gdsfactory comes with a <a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html">library of basic cells</a> you can use. These can help you create more complex components more quickly, without having to calculate the position of every polygon point.</p>
<p>Some of the most useful ones include:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#rectangle"><code class="docutils literal notranslate"><span class="pre">gf.components.rectangle</span></code></a></p></li>
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#ellipse"><code class="docutils literal notranslate"><span class="pre">gf.components.ellipse</span></code></a></p></li>
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#circle"><code class="docutils literal notranslate"><span class="pre">gf.components.circle</span></code></a></p></li>
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#ring"><code class="docutils literal notranslate"><span class="pre">gf.components.ring</span></code></a></p></li>
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#bend-circular"><code class="docutils literal notranslate"><span class="pre">gf.components.bend_circular</span></code></a></p></li>
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#bend-euler"><code class="docutils literal notranslate"><span class="pre">gf.components.bend_euler</span></code></a></p></li>
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#tapers"><code class="docutils literal notranslate"><span class="pre">gf.components.tapers</span></code></a> (I know we just made one)</p></li>
<li><p><a class="reference external" href="https://gdsfactory.github.io/gdsfactory/notebooks/04_components_shapes.html#text"><code class="docutils literal notranslate"><span class="pre">gf.components.text</span></code></a></p></li>
</ul>
</section>
</section>
<section id="adding-ports">
<h2>Adding ports<a class="headerlink" href="#adding-ports" title="Permalink to this heading">#</a></h2>
<p>Ports are placed at the inputs and outputs of components and cells–places where it should line up with other components. You must specify the direction the port is facing (generally outwards, away from the component). You can also specify the width of the port, which is generally just the width of the input or output of the component it is attached to.</p>
<p>Ports make it easier to attach components together. As you make more complex designs and start connecting different components together, ports will help to automatically move, rotate, and align components together by matching up their respective ports.</p>
<p>Let’s expand our taper from earlier by adding ports. (Note that it’s common for <em>all</em> ports to point away from the component, instead of towards it.)</p>
<p><em>(This script is complete, it should run “as is”)</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>

<span class="nd">@gf</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">taper</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">width_in</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">width_out</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
    <span class="c1"># Create a component containing a polygon for the taper</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>

    <span class="c1"># Add polygon defining the taper waveguide shape</span>
    <span class="n">c</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span>
        <span class="n">points</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="o">-</span><span class="n">width_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">],</span> 
        <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Add ports to the component</span>
    <span class="n">ports</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s2">"o1"</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">width_in</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="s2">"optical"</span><span class="p">),</span>
        <span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s2">"o2"</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">width_out</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="s2">"optical"</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">c</span><span class="o">.</span><span class="n">add_ports</span><span class="p">(</span><span class="n">ports</span><span class="p">)</span>

    <span class="c1"># Return the constructed component</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="c1"># Visualize the taper</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">taper</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8cd2e668ea290a26c2accf00af77779546c7c013cd2bc0961828cf7d6b7e7f23.png" src="../_images/8cd2e668ea290a26c2accf00af77779546c7c013cd2bc0961828cf7d6b7e7f23.png"/>
</div>
</div>
<p>And there we’ve added ports that can be used for translating and aligning this component to other components as part of a larger circuit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>gdsfactory’s port naming convention is:</p>
<ul class="simple">
<li><p>ports are numbered clock-wise starting from the bottom left corner</p></li>
<li><p>optical ports are prefixed with “o”</p></li>
<li><p>electrical ports are prefixed with “e”</p></li>
<li><p>numbering is 1-indexed, not 0-indexed</p></li>
</ul>
</div>
</section>
<section id="components-using-references">
<h2>Components using references<a class="headerlink" href="#components-using-references" title="Permalink to this heading">#</a></h2>
<p>As shown previously, <code class="docutils literal notranslate"><span class="pre">gdsfactory</span></code> defines your component once in memory. Any time you then use it, you are adding a reference to the same component. A reference does not contain any geometry, but is essentially a pointer to an existing component. There is no limit to the number of references you can have to a component.</p>
<p>The GDSII specification is built around the use of references, so gdsfactory also uses them (with the <code class="docutils literal notranslate"><span class="pre">Component.add_ref()</span></code> function or the <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> operator).</p>
<p>In the previous example, we created and parameterized the geometry of a taper. We’ll now include that taper cell  in a 2x2 multimode interferometer (MMI) by using references. We’ll learn about MMI’s later, but for now just know that they have a wide (and therefore multimodal) waveguide section with inputs and outputs on each side, where we’ll attach our tapers.</p>
<p>By using references to add tapers to our MMI, we could easily change the parameters of all four tapers without having to redraw each one individually.</p>
<p>Let’s make a function that returns an MMI component. Right off the bat, we’ll make it a parametric component. We’ll call it <code class="docutils literal notranslate"><span class="pre">mmi2x2()</span></code>. It will take as arguments the width of the multimode section, the length of the multimode section, as well as parameters for the tapers. It will return an MMI component with four tapers attached to it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>

<span class="nd">@gf</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mmi2x2</span><span class="p">(</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.5</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.125</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># Determine the shape of the taper we'll use</span>
    <span class="n">taper_length</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">taper_width_in</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">taper_width_out</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">taper_c</span> <span class="o">=</span> <span class="n">taper</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">taper_length</span><span class="p">,</span> <span class="n">width_in</span><span class="o">=</span><span class="n">taper_width_in</span><span class="p">,</span> <span class="n">width_out</span><span class="o">=</span><span class="n">taper_width_out</span><span class="p">)</span>

    <span class="c1"># Add the MMI body</span>
    <span class="n">mmi</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">mmi</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">port_type</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># Add ports to the MMI body</span>
    <span class="n">port_width</span> <span class="o">=</span> <span class="n">taper_width_out</span>
    <span class="n">port_center</span> <span class="o">=</span> <span class="n">gap</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">taper_width_out</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">mmi</span><span class="o">.</span><span class="n">add_ports</span><span class="p">([</span>
        <span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s1">'o1'</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">port_center</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">port_width</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="s2">"optical"</span><span class="p">),</span>
        <span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s1">'o2'</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">port_center</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">port_width</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="s2">"optical"</span><span class="p">),</span>
        <span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s1">'o3'</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">port_center</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">port_width</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="s2">"optical"</span><span class="p">),</span>
        <span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s1">'o4'</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="o">-</span><span class="n">port_center</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">port_width</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="s2">"optical"</span><span class="p">),</span>
    <span class="p">])</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
    <span class="c1"># We can use add_ref</span>
    <span class="n">mmi_ref</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">mmi</span><span class="p">)</span>
    <span class="c1"># or we can use the left shift operator as shorthand</span>
    <span class="n">taper_refs</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">taper_c</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

    <span class="c1"># Move the tapers into position</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">port</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s2">"o1"</span><span class="p">,</span> <span class="s2">"o2"</span><span class="p">,</span> <span class="s2">"o3"</span><span class="p">,</span> <span class="s2">"o4"</span><span class="p">]):</span>
        <span class="n">taper_refs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="s2">"o2"</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">mmi_ref</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="n">port</span><span class="p">])</span>

    <span class="c1"># The composed component needs to have just its ports alone exposed</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">taper_refs</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add_port</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"o</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">ref</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o1"</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">auto_rename_ports</span><span class="p">()</span> <span class="c1"># for consistency</span>

    <span class="k">return</span> <span class="n">c</span>

<span class="n">gf</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="n">mmi2x2</span><span class="p">()</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3338384397563580408313bb2883518d595b910c0880eba7f56240d1c38edb96.png" src="../_images/3338384397563580408313bb2883518d595b910c0880eba7f56240d1c38edb96.png"/>
</div>
</div>
<p>For simpler components, you may find it easier to just do the math and calculate how different geometries fit together yourself. But for more complex components, it’s often easier to use references to attach other components together. It also makes swapping out or modifying components easier, because you won’t have to redo the math.</p>
<p>Below is an example of calculating inline where to place tapers without connecting its ports.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@gf</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mmi2x2</span><span class="p">(</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.5</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.125</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>

    <span class="c1"># Add the MMI body</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">port_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">rect_ref</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
    <span class="n">rect_ref</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># We'll have to do some math to figure out where to put the tapers</span>
    <span class="n">taper_length</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">taper_width_in</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">taper_width_out</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">taper_c</span> <span class="o">=</span> <span class="n">taper</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">taper_length</span><span class="p">,</span> <span class="n">width_in</span><span class="o">=</span><span class="n">taper_width_in</span><span class="p">,</span> <span class="n">width_out</span><span class="o">=</span><span class="n">taper_width_out</span><span class="p">)</span>
    
    <span class="n">tapers</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">taper_c</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">taper_length</span><span class="p">),</span> <span class="p">(</span><span class="n">taper_width_out</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">taper_c</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">taper_length</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">taper_width_out</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">taper_c</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="n">taper_length</span> <span class="o">+</span> <span class="n">length</span><span class="p">,(</span><span class="n">taper_width_out</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">180</span><span class="p">),</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">taper_c</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="n">taper_length</span> <span class="o">+</span> <span class="n">length</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">taper_width_out</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">180</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">taper_ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tapers</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add_port</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"o</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">taper_ref</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o1"</span><span class="p">])</span>
    <span class="n">c</span><span class="o">.</span><span class="n">auto_rename_ports</span><span class="p">()</span> <span class="c1"># for consistency</span>

    <span class="k">return</span> <span class="n">c</span>

<span class="n">gf</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="n">mmi2x2</span><span class="p">()</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b2f6da08b3c493a9d5fed5363c833091be885faab938da00ffbf056137980cd3.png" src="../_images/b2f6da08b3c493a9d5fed5363c833091be885faab938da00ffbf056137980cd3.png"/>
</div>
</div>
</section>
<section id="exporting-components-to-gds-files">
<h2>Exporting components to GDS files<a class="headerlink" href="#exporting-components-to-gds-files" title="Permalink to this heading">#</a></h2>
<p>Now that we’ve created our geometry, we may want to export it to be manufactured, to be shared with others, to be imported into some other tool (potentially Lumerical) or to be added to a PDK as a fixed GDS file instead of a code-defined shape. This is as simple as calling the <code class="docutils literal notranslate"><span class="pre">Component.write_gds()</span></code> function on the component and supplying a path. This will write the component to a GDS file in the current directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">taper</span><span class="p">()</span><span class="o">.</span><span class="n">write_gds</span><span class="p">(</span><span class="s1">'taper.gds'</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="importing-components-from-gds-files">
<h2>Importing components from GDS files<a class="headerlink" href="#importing-components-from-gds-files" title="Permalink to this heading">#</a></h2>
<p>It is sometimes necessary to import a GDS file into gdsfactory. Perhaps you created the geometry using some other software, such as Meep, and you would like to the use the geometry in a circuit built using gdsfactory. Or, perhaps you were given a PDK from a fab or another designer where the components were provided as GDS files. While gdsfactory has functions to convert the geometry, there are several other steps you need to take after this conversion to get a useful gdsfactory component.</p>
<p>For this example, we’ll be using a GDS of a y-branch that is part of the open-source <a class="reference external" href="https://github.com/SiEPIC/SiEPIC_EBeam_PDK/tree/master">SiEPIC EBeam PDK</a>.</p>
<p><a class="reference download internal" download="" href="../_downloads/beb2adb9a01532f34c648038732f48c2/ebeam_y_1550.gds"><code class="xref download docutils literal notranslate"><span class="pre">ebeam_y_1550.gds</span></code></a> (or, get it on <a class="reference external" href="https://github.com/BYUCamachoLab/Photonics-Bootcamp/blob/main/book/files/ebeam_y_1550.gds">GitHub</a>)</p>
<div style="text-align: center">
<img alt="SiEPIC Y-branch" src="https://github.com/BYUCamachoLab/Photonics-Bootcamp/blob/main/book/images/siepic-ybranch.png?raw=true" style="max-width: 500px"/>
</div><p>gdsfactory provides the convenient <code class="docutils literal notranslate"><span class="pre">import_gds()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdsfactory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gf</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">"../files/ebeam_y_1550.gds"</span>

<span class="c1"># Create a component with the same name as our gds</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"ebeam_y_1550"</span><span class="p">)</span> 

<span class="c1"># Add the geometry from the gds as a reference to our component</span>
<span class="c1"># The &lt;&lt; is shorthand for c.add_ref()</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">gf</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">import_gds</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="c1"># Show the component</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/525586df4e7a1c9d5884bdb100fa84e5866783d12b05da9e6511311e6a19b9ae.png" src="../_images/525586df4e7a1c9d5884bdb100fa84e5866783d12b05da9e6511311e6a19b9ae.png">
</img></div>
</div>
<p>Now we have a geometry, but in order to use it in gdsfactory, we need ports. We can add these manually, getting the locations from KLayout (you can hover your mouse and read coordinates or examine the polygons vertices themselves and calculate the midpoints):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add ports. </span>
<span class="n">c</span><span class="o">.</span><span class="n">add_port</span><span class="p">(</span><span class="s2">"o1"</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">7.4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">c</span><span class="o">.</span><span class="n">add_port</span><span class="p">(</span><span class="s2">"o2"</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mf">7.4</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">),</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">c</span><span class="o">.</span><span class="n">add_port</span><span class="p">(</span><span class="s2">"o3"</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mf">7.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.75</span><span class="p">),</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="n">c</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b822245022c69d7ae7080da2f4a94887463dff4a976b1f7740fcf95724c67797.png" src="../_images/b822245022c69d7ae7080da2f4a94887463dff4a976b1f7740fcf95724c67797.png"/>
</div>
</div>
</section>
<section id="connecting-components-using-ports">
<h2>Connecting components using ports<a class="headerlink" href="#connecting-components-using-ports" title="Permalink to this heading">#</a></h2>
<p>We can connect separate components together by referencing ports.</p>
<p>Let’s take this straight component:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">straight</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">straight</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">straight</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d3acc6d5b50a155e84d52c71155f8041bfd3d4f97e025c44b2a1ec8cdb0d150d.png" src="../_images/d3acc6d5b50a155e84d52c71155f8041bfd3d4f97e025c44b2a1ec8cdb0d150d.png"/>
</div>
</div>
<p>and this bend:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bend</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">bend_circular</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">bend</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dc026d8effd787190ca7031d621ad0d8d29fd58be7cc6e9844bda85fa7470d9c.png" src="../_images/dc026d8effd787190ca7031d621ad0d8d29fd58be7cc6e9844bda85fa7470d9c.png"/>
</div>
</div>
<p>and connect them together. This must be done in a <code class="docutils literal notranslate"><span class="pre">Component</span></code>, which, if you’ll recall, is essentially a canvas on which you can draw your geometry. That includes drawing components, which is what we’ll do here by adding references.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>

<span class="n">straight_ref</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">straight</span><span class="p">)</span>
<span class="n">bend_ref</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">add_ref</span><span class="p">(</span><span class="n">bend</span><span class="p">)</span>

<span class="n">bend_ref</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">"o1"</span><span class="p">,</span> <span class="n">straight_ref</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o2"</span><span class="p">])</span>

<span class="n">c</span><span class="o">.</span><span class="n">plot_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c3c84964c185c8b51ccb165517c43b76dcf286d720e9185619db757efdbbf6b2.png" src="../_images/c3c84964c185c8b51ccb165517c43b76dcf286d720e9185619db757efdbbf6b2.png"/>
</div>
</div>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Pick a GDS Factory component and recreate it using polygons</p></li>
<li><p>Use Boolean operators to create a circular ring and then a racetrack ring.</p></li>
<li><p>Create a directional coupler circuit using only GDS Factory default components</p></li>
</ol>
</section>
<div class="toctree-wrapper compound">
</div>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="prev-next-footer d-print-none">
<div class="prev-next-area">
<a class="left-prev" href="layer_stack.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Defining the layer stack</p>
</div>
</a>
<a class="right-next" href="gds_to_meep.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">GDS to Meep</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> Contents
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#elements-of-a-component">Elements of a Component</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polygons">Polygons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ports">Ports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#labels">Labels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components-from-polygons">Components from polygons</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#translation-and-rotation-of-polygons">Translation and rotation of polygons</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boolean-operations">Boolean operations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-cells">Parametric cells</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapes-and-generic-cells">Shapes and generic cells</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-ports">Adding ports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components-using-references">Components using references</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exporting-components-to-gds-files">Exporting components to GDS files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-components-from-gds-files">Importing components from GDS files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-components-using-ports">Connecting components using ports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By CamachoLab and Google
</p>
</div>
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2023.
      <br/>
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>
<footer class="bd-footer">
</footer>
<script src="../_static/scripts/chattutor.config.js"></script><script src="../_static/scripts/chattutor.min.js" type="module"></script></body>
</html>